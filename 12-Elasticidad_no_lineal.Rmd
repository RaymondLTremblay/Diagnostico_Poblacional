# Elasticidad no lineal


## Por : Raymond L. Tremblay

## La elasticidad no lineal

La elasticidad no lineal (@hodgson2004methodological) se refiere a que los analisis de elasticidad (@caswell2000matrix, @de2000elasticities) como explicado en el capitulo 10 no son estrictamente lineal y que las perturbaciones en una población pueden tener efectos no lineales en las respuestas de los parametros de densidad o indices de crecimientos.  Esos cambios no lineales se pueden observar tambien en la dinamica de transiciones. Si las perturbaciones son pequeñas el uso de analisis de elasticidad pudiesen ser aceptable, por consecuencia los efectos no lineales pueden ser ignorados, pero si las perturbaciones son grandes, los efectos no lineales pueden ser importantes y impactar los procesos de dinamica poblacionales.  En los analisis de dinamica poblacional estamos interesado a no solamente el crecimiento de la poblacion pero que pudiese pasar si hubiese cambios pequeños y grandes en los parametros de la matriz sobre los indices de crecimiento y densidad poblacional tal como la supervivencia, crecimiento y fecundidad.  La elasticidad no lineal es una herramienta que permite evaluar esos cambios que sean por causa naturales tal como variación ambientales (succesión, dezlisamiento de terreno, mortandad de forofito, cambio climatologico), o antropogénicos (extración de individuos o hasta manejo del sitio para promover el crecimiento de la población). 

Es importante reconocer que los analisis de elasticidad y sensitividad ignoran los efectos de la dinamica de transiciones y provee una aproximación linear de cambios que muchas veces no son lineales (@stott2012beyond).  

La elasticidad no lineal es una herramienta que permite evaluar esos cambios que sean por causa naturales tal como variación ambientales (succesión, dezlisamiento de terreno, mortandad de forofito, cambio climatologico), o antropogénicos (extración de individuos o hasta manejo del sitio para promover el crecimiento de la población). 

## Metodología

El método que presentamos aqui es el desarollado por Hodgson y Townley (2004) (@hodgson2004methodological, @stott2012beyond), los cuales presentan un método para calcular la elasticidad no lineal. No se discutirá en detalle el método, pero se presentará un ejemplo de como calcular la elasticidad no lineal. 
 

```{r, message=FALSE}
library(popdemo)
```


## Ejemplo tradicional

Aqui la matriz de lefkovitch para la planta *Lepanthes rubripetala* (Tremblay et al. 2015) es presentada.

```{r chap10_1, message=FALSE}

#Capturar los datos de la matriz para L. rubripetala (Tremblay et al. 2015)
Lr1 <- matrix(c(0.4324, 0,      0,     0.15,
               0.3784, 0.8459, 0,     0,
               0,      0.0034, 0.7954,0.2300,
               0,      0.0890, 0.1841,0.7510), byrow=TRUE,ncol=4)

#Capturar las categorias de estado
estadios <- c("PL", "J", "NR", "AR")
colnames(Lr1) <- rownames(Lr1) <- estadios

#Obtener la matriz L. rubripetala 
Lr1 <- matrix(Lr1[1:4, ], nrow = 4, dimnames = list(estadios, estadios))
Lr1

```

Aqui la matriz de elasticad calculado anteriormente.

Nota que la suma de todos los elementos de la matriz de elasticidad. Proporcionalmente el cambio de la supervivencia de el estado de Adulto Reproductivo (AR) tiene el mayor impacto sobre la tasa de crecimiento poblacional.  Un pequeño cambio resultaria en un cambio de 0.311 en la tasa de crecimiento poblacional. Al contrario una plantula que se queda plantula (estasis) tuviese muy poco impacto en el crecimiento de la población (0.018). Esos cambios son lineales y son validos si las perturbaciones son pequeñas. Recordar que los indices de sensitividad para tansiciones y estasis son en unidades diferentes que los fecundidades. 


```{r chap10_2, message=FALSE}
 # Matriz de elasticidad
elasticidad<- round(elas(Lr1), digit = 3)

elasticidad
```





## Valor biológico

## Métodos de calculo

En el paquete de R `popdemo` se puede calcular la elasticidad no lineal *transfer function* con la función **tfam_lambda** y **tfam_inertia**.  La función **tfam_lambda** calcula la elasticidad no lineal. 

La función **tfam_lambda** calcula la elasticidad no lineal de la matriz de edad o de etapas de cada elemento de la matriz A que no sean 0 (zero). Esa función es practica para vizualizar como las perturbaciones en las transiciones del ciclo de vida impacto lambda y observar la no-linealidad de los efectos.   


De las 10 transiciones , estasis o fecundidad, 9 tienen un efecto no lineal sobre lambda. Nota primero que el rango de los ejes de "x" (efecto de perturbaciones) y la "y" el crecimiento porblacional intrinsico varia por cada grafico. La transición de plantula a plantula tiene efecto no lineal sobre lambda bastante pronunciado (primer cuadro a la izquierda primera fila). Se observa que aumentar la proporción de individuos que se quedan en esta etapa no tiene mucho efecto hasta que la perturbación aumenta de ± .5, y despues el efecto es bastante consistente. 

La transición de juvenil a no reproductivo tiene un efecto no lineal sobre lambda.  La transición de juvenil a adulto reproductivo tiene un efecto no lineal sobre lambda.  La transición de no reproductivo a adulto reproductivo tiene un efecto no lineal


```{r}
n0 <- c(0, 46, 38, 82)

tfmat_lamb=tfam_lambda(Lr1)

plot(tfmat_lamb)
```





sens1=sens(Lr1)[1,1]
sens1

abline(eigs(Lr1, "lambda"), sens1, lty=2)



La función **tfam_inertia** calcula la cuan grande o pequeña una población que no este a su equilibro estable puede ser perturbada por consecuencia de dinamica de transiciones.  Stott y colegas (@stott2012beyond) presentan no solamente que el efecto de perturbaciones no es lineal sobre el cambio en lambda pero tambien sobre la inertia, entonces el efecto que tiene sobre poblaciones que no esten a su equilibrio estable. 

Usamos la misma temrinalogía de Stott (@stott2012beyond) para calcular el efecto de elasticidad sobre la inertia de la matriz de *L. rubripetala*. Se evalua el efecto del basado en la estructura del vector de estado inicial. En otra palabra si la cantidad de individuos se encuentra en un estado especifico. El "upper" seria los individuos en la etapa mayor (en este caso los adultos reproductivos), el "lower" en la estapa menor (en las plantulas) y una estructura de población en al inicio del estudio.


Para evaluar el efecto de no lineal de 

```{r}


n0 <- c(0, 46, 38, 82)

tf2<-tfa_inertia(Lr1, vector=n0, d=c(0,0,0,1), e=c(0,0,1,1), prange=seq(-0.18,0.02,0.01))
plot(tf2,ylim=c(0, 2),main="Population inertia",cex.axis=1.4,cex.lab=1.5)
inertia<-inertia(Lr1, vector=n0)
sens2<-tfs_inertia(Lr1, vector=n0, d=c(0,0,0,1), e=c(0,0,1,1), tolerance=1e-5)
abline(inertia, sens2, lty=2, col="red")
```



```{r}
n0 <- c(0, 46, 38, 82)

tfmatU=tfam_inertia(Lr1, bound = "upper")
tfmat_I=tfam_inertia(Lr1, vector = n0)
tfmatL=tfam_inertia(Lr1, bound = "lower")
plot(tfmatU)
plot(tfmat_I)
plot(tfmatL)
```




## Paquete de R para calcular le eslaticidad no lineal


## Referencias