[["variación-demográfica-espacial-y-temporal.html", "Capítulo 24 Variación Demográfica, Espacial y Temporal 24.1 Variación Demográfica 24.2 Aumentando el tamaño de muestra", " Capítulo 24 Variación Demográfica, Espacial y Temporal La variación en los estimados de parámetros tienen impacto sobre la estimación de lambda. Hay 3 tipos de variación que podemos tomar en cuenta y evaluar su impacto sobre la estimación de lambda: Variación Demográfica Variación Espacial Variación Temporal 24.1 Variación Demográfica Uno de las preguntas principales que se hace sobre la confiabilidad de los trabajos de dinámica poblacional con especies raras, es cual es el impacto de tener pocos individuos para estimar los parámetros de la matriz poblacional sobre lambda. Aqui se presente un método de calcular la varianza de lambda, tomando en cuenta los parámetros, la sensitividad y el tamaño de muestra que se uso para calcular los parámetros. Con experiencia es lógico que con muchos individuos, la varianza es pequeña, pero con pocos individuos, la varianza debería ser ser grande. Pero en el caso del impacto de esa varianza sobre lambda se debería tomar en cuenta la sensitividad de lambda a los parámetros de la matriz. En otra palabra parámetros con alta sensitividad sobre lambda, deberían tener una varianza grande cuando los tamaños de muestra son pequenõs, pero que el efecto de confianza sea basado en el tamaño de muestra. El método presentado aquí es una modificación de la formula sugerido por Thomas A. Ebert en su libro Plant and Animal Populations. Methods in Demography (Ebert 1999). La varianza de lambda deberia ser ajustado por el tamaño de muestra y la sensitividad de lambda a los parámetros de la matriz poblacional. \\[Var(\\lambda) = \\sum_{i=1}^{n} \\sum_{j=1}^{n} \\frac{\\partial \\lambda}{\\partial a_{ij}}^2 V(a_{ij})\\] La sensitividad, \\(\\frac{\\partial \\lambda}{\\partial a_{ij}}\\), de lambda a los parámetros de la matriz poblacional, \\(a_{ij}\\), se puede calcular con la función sens del paquete popbio. y por consecuencia la varianza de cada parámetros es \\[Var(a_{ij}) = \\frac{a_{ij}(1-a_{ij})}{N_{ij}}\\], donde N es el tamaño de muestra. En este primer ejemplo usamos la formula presentado por Ebert para calcular la varianza de lambda, tomando en cuenta la sensitividad de lambda a los parámetros de la matriz poblacional y el tamaño de muestra. Pero note que estamos asumiendo que 1) la sensitividad de lambda a los parámetros de la matriz poblacional es constante, 2) la razón son binomio (sobrevive o no), que los intervalos de confianza tienen una distribución normal. El ultimo, pudiese ser un problema cuando los parámetros se encuentra cerca de 0 o 1, resultando en varianza que so ilógicos (negativos o mayor de uno). Los datos necesarios para calcular la estocasticidad demográfica son los siguientes La matriz de transición poblacional El tamaño de muestra de cada etapa La sensitividad de lambda a los parámetros de la matriz poblacional Para el ejercicio usamos datos de Lepanthes eltoroensis de una población y un periodo de tiempo. los datos se encuentran en el paquete raretrans. library(raretrans) # activar el paquete library(tidyverse) # activar el paquete library(popbio) # activar el paquete) unique(L_elto$POPNUM) # Verificar cuantas poblaciones hay ## [1] 209 229 231 234 235 243 250 255 268 274 275 904 905 906 907 908 911 913 914 ## [20] 915 916 926 266 NA onepopt1 &lt;- L_elto %&gt;% filter(POPNUM== 209) # Usando todas las poblaciones de 209 # popbio::projection.matrix no funciona con el formato *tibbles*, por consecuencia se convierte en data.frame head(onepopt1) # Ahora tenemos solamente datos de la población #209 ## # A tibble: 6 × 13 ## POPNUM year seedlings adults fertility IND_NUM stage next_stage first_year ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 209 1 1 6 0 67 j j 1 ## 2 209 1 1 6 0 68 a a 1 ## 3 209 1 1 6 0 69 a a 1 ## 4 209 1 1 6 0 70 a a 1 ## 5 209 1 1 6 0 71 j a 1 ## 6 209 1 1 6 0 72 a a 1 ## # ℹ 4 more variables: last_year &lt;dbl&gt;, recruited &lt;lgl&gt;, died &lt;dbl&gt;, ## # lifespan &lt;int&gt; # Crear TF = TRUE, añadir para formatear correctamente. TF &lt;- popbio::projection.matrix(as.data.frame(onepopt1), stage = stage, fate = next_stage, fertility=&quot;fertility&quot;, sort=c(&quot;p&quot;,&quot;j&quot;,&quot;a&quot;), TF = TRUE) ## Warning: Error sorting matrix. ## Make sure that levels in stage and fate columns ## match stages listed in sort option above. ## Printing unsorted matrix instead! TF # Este es la estructura de etapas de vida para esa población. Nota que tenemos dos matrices, una de transiciones **T** y otra de fertilidad **F**. ## $T ## ## a j p ## a 0.84444444 0.03030303 0.16666667 ## j 0.06666667 0.56565657 0.16666667 ## m 0.08888889 0.40404040 0.66666667 ## ## $F ## ## a j p ## a 0.05555556 0.00000000 0.00000000 ## j 0.00000000 0.00000000 0.00000000 ## m 0.00000000 0.00000000 0.00000000 Calcular la sensitividad de la matriz A matA=TF$T+TF$F matA ## ## a j p ## a 0.90000000 0.03030303 0.16666667 ## j 0.06666667 0.56565657 0.16666667 ## m 0.08888889 0.40404040 0.66666667 matAsens=as.matrix(sensitivity(matA)) # matrix de sensitividad matAsens ## ## a j p ## a 0.5308370 0.2088967 0.3655064 ## j 0.4211186 0.1657199 0.2899601 ## m 0.4407004 0.1734258 0.3034431 Calcular cuanto individuos habia en el primer periodo como un estimado tipico del tamaño poblacional N_t1=L_elto %&gt;% filter(POPNUM== 209, year==1) Nt1 &lt;- get_state_vector(N_t1, stage = stage, sort=c(&quot;p&quot;,&quot;j&quot;,&quot;a&quot;)) Nt1 ## [1] 1 5 6 Convertimos la matriz de transiciones y de sensitividad y la unimos en un solo data.frame DFmat=as.data.frame(matA)# Convertir matriz en un data frame #DFmat DFsens=as.data.frame(as.vector(matAsens)) # Método alternativo para convertir matriz en un data frame Contribucion_var=merge(DFmat, DFsens, by=0) # Unir los dos data frames Contribucion_var$N=c(1,1,1,5,5,5,6,6,6) # Añadir el tamaño de muestra Contribucion =Contribucion_var |&gt; rename(&quot;Sensitividad&quot; = &quot;as.vector(matAsens)&quot;) |&gt; # Renombrar la columna e sensitividad rename(p =Freq) # Renombrar la columna de la matriz de transición Contribucion ## Row.names Var1 Var2 p Sensitividad N ## 1 1 a a 0.90000000 0.5308370 1 ## 2 2 j a 0.06666667 0.4211186 1 ## 3 3 m a 0.08888889 0.4407004 1 ## 4 4 a j 0.03030303 0.2088967 5 ## 5 5 j j 0.56565657 0.1657199 5 ## 6 6 m j 0.40404040 0.1734258 5 ## 7 7 a p 0.16666667 0.3655064 6 ## 8 8 j p 0.16666667 0.2899601 6 ## 9 9 m p 0.66666667 0.3034431 6 Calcular la vvarianza y la contribución de la varianza a lambda Contribucion=Contribucion |&gt; mutate(V_aij = (p*(1-p)/N)) |&gt; # Calcular la varianza de los parámetros sin tomar en cuenta la sensitividad mutate(Cont_deVar_lambda = (Sensitividad^2)*V_aij^2) # Calcular la contribución de la varianza de cada parámetro a lambda Contribucion_var ## Row.names Var1 Var2 Freq as.vector(matAsens) N ## 1 1 a a 0.90000000 0.5308370 1 ## 2 2 j a 0.06666667 0.4211186 1 ## 3 3 m a 0.08888889 0.4407004 1 ## 4 4 a j 0.03030303 0.2088967 5 ## 5 5 j j 0.56565657 0.1657199 5 ## 6 6 m j 0.40404040 0.1734258 5 ## 7 7 a p 0.16666667 0.3655064 6 ## 8 8 j p 0.16666667 0.2899601 6 ## 9 9 m p 0.66666667 0.3034431 6 La suma de la contribución de la varianza de cada parámetro a lambda es la varianza de lambda Contribucion |&gt; summarise(V_lambda = sum(Cont_deVar_lambda)) # Calcular la varianza de lambda ## V_lambda ## 1 0.004623459 El intervalo de confianza de lambda se puede calcular con la formula de Ebert lambda +/- 1.96*sqrt(V_lambda) Por consecuencia el intervalo de confianza de lambda de esta población considerando la estocasticidad demogrófica rodea entre 0.89 y 1.16. ICupper=lambda(matA)+ 1.96*sqrt(sum(Contribucion$Cont_deVar_lambda)) LClower=lambda(matA)- 1.96*sqrt(sum(Contribucion$Cont_deVar_lambda)) ICupper ## [1] 1.159955 LClower ## [1] 0.8934106 24.2 Aumentando el tamaño de muestra En esta parte su usa la misma matriz pero con un tamaño de muestra mayor de 10, 50, 60. lo que se observa es que tenemos más confianza en el rango de lambda, 0.99 a 1.06. DFmat=as.data.frame(matA)# Convertir matriz en un data frame #DFmat DFsens=as.data.frame(as.vector(matAsens)) # Método alternativo para convertir matriz en un data frame Contribucion_var=merge(DFmat, DFsens) # Unir los dos data frames Contribucion_var$N=c(10,10,10,50,50,50,60,60,60) # Añadir el tamaño de muestra, se aumento el tamaño de muestra Contribucion_var =Contribucion_var |&gt; rename(&quot;Sensitividad&quot; = &quot;as.vector(matAsens)&quot;) |&gt; # Renombrar la columna e sensitividad rename(p =Freq) # Renombrar la columna de la matriz de transición Contribucion_var ## Var1 Var2 p Sensitividad N ## 1 a a 0.90000000 0.5308370 10 ## 2 j a 0.06666667 0.5308370 10 ## 3 m a 0.08888889 0.5308370 10 ## 4 a j 0.03030303 0.5308370 50 ## 5 j j 0.56565657 0.5308370 50 ## 6 m j 0.40404040 0.5308370 50 ## 7 a p 0.16666667 0.5308370 60 ## 8 j p 0.16666667 0.5308370 60 ## 9 m p 0.66666667 0.5308370 60 ## 10 a a 0.90000000 0.4211186 10 ## 11 j a 0.06666667 0.4211186 10 ## 12 m a 0.08888889 0.4211186 10 ## 13 a j 0.03030303 0.4211186 50 ## 14 j j 0.56565657 0.4211186 50 ## 15 m j 0.40404040 0.4211186 50 ## 16 a p 0.16666667 0.4211186 60 ## 17 j p 0.16666667 0.4211186 60 ## 18 m p 0.66666667 0.4211186 60 ## 19 a a 0.90000000 0.4407004 10 ## 20 j a 0.06666667 0.4407004 10 ## 21 m a 0.08888889 0.4407004 10 ## 22 a j 0.03030303 0.4407004 50 ## 23 j j 0.56565657 0.4407004 50 ## 24 m j 0.40404040 0.4407004 50 ## 25 a p 0.16666667 0.4407004 60 ## 26 j p 0.16666667 0.4407004 60 ## 27 m p 0.66666667 0.4407004 60 ## 28 a a 0.90000000 0.2088967 10 ## 29 j a 0.06666667 0.2088967 10 ## 30 m a 0.08888889 0.2088967 10 ## 31 a j 0.03030303 0.2088967 50 ## 32 j j 0.56565657 0.2088967 50 ## 33 m j 0.40404040 0.2088967 50 ## 34 a p 0.16666667 0.2088967 60 ## 35 j p 0.16666667 0.2088967 60 ## 36 m p 0.66666667 0.2088967 60 ## 37 a a 0.90000000 0.1657199 10 ## 38 j a 0.06666667 0.1657199 10 ## 39 m a 0.08888889 0.1657199 10 ## 40 a j 0.03030303 0.1657199 50 ## 41 j j 0.56565657 0.1657199 50 ## 42 m j 0.40404040 0.1657199 50 ## 43 a p 0.16666667 0.1657199 60 ## 44 j p 0.16666667 0.1657199 60 ## 45 m p 0.66666667 0.1657199 60 ## 46 a a 0.90000000 0.1734258 10 ## 47 j a 0.06666667 0.1734258 10 ## 48 m a 0.08888889 0.1734258 10 ## 49 a j 0.03030303 0.1734258 50 ## 50 j j 0.56565657 0.1734258 50 ## 51 m j 0.40404040 0.1734258 50 ## 52 a p 0.16666667 0.1734258 60 ## 53 j p 0.16666667 0.1734258 60 ## 54 m p 0.66666667 0.1734258 60 ## 55 a a 0.90000000 0.3655064 10 ## 56 j a 0.06666667 0.3655064 10 ## 57 m a 0.08888889 0.3655064 10 ## 58 a j 0.03030303 0.3655064 50 ## 59 j j 0.56565657 0.3655064 50 ## 60 m j 0.40404040 0.3655064 50 ## 61 a p 0.16666667 0.3655064 60 ## 62 j p 0.16666667 0.3655064 60 ## 63 m p 0.66666667 0.3655064 60 ## 64 a a 0.90000000 0.2899601 10 ## 65 j a 0.06666667 0.2899601 10 ## 66 m a 0.08888889 0.2899601 10 ## 67 a j 0.03030303 0.2899601 50 ## 68 j j 0.56565657 0.2899601 50 ## 69 m j 0.40404040 0.2899601 50 ## 70 a p 0.16666667 0.2899601 60 ## 71 j p 0.16666667 0.2899601 60 ## 72 m p 0.66666667 0.2899601 60 ## 73 a a 0.90000000 0.3034431 10 ## 74 j a 0.06666667 0.3034431 10 ## 75 m a 0.08888889 0.3034431 10 ## 76 a j 0.03030303 0.3034431 50 ## 77 j j 0.56565657 0.3034431 50 ## 78 m j 0.40404040 0.3034431 50 ## 79 a p 0.16666667 0.3034431 60 ## 80 j p 0.16666667 0.3034431 60 ## 81 m p 0.66666667 0.3034431 60 Contribucion_var=Contribucion_var |&gt; mutate(V_aij = (p*(1-p)/N)) |&gt; # Calcular la varianza de los parámetros sin tomar en cuenta la sensitividad mutate(Cont_deVar_lambda = (Sensitividad^2)*V_aij^2) # Calcular la contribución de la varianza de cada parámetro a lambda Contribucion_var ## Var1 Var2 p Sensitividad N V_aij Cont_deVar_lambda ## 1 a a 0.90000000 0.5308370 10 0.0090000000 2.282482e-05 ## 2 j a 0.06666667 0.5308370 10 0.0062222222 1.090971e-05 ## 3 m a 0.08888889 0.5308370 10 0.0080987654 1.848247e-05 ## 4 a j 0.03030303 0.5308370 50 0.0005876951 9.732548e-08 ## 5 j j 0.56565657 0.5308370 50 0.0049137843 6.803847e-06 ## 6 m j 0.40404040 0.5308370 50 0.0048158351 6.535301e-06 ## 7 a p 0.16666667 0.5308370 60 0.0023148148 1.509923e-06 ## 8 j p 0.16666667 0.5308370 60 0.0023148148 1.509923e-06 ## 9 m p 0.66666667 0.5308370 60 0.0037037037 3.865403e-06 ## 10 a a 0.90000000 0.4211186 10 0.0090000000 1.436461e-05 ## 11 j a 0.06666667 0.4211186 10 0.0062222222 6.865937e-06 ## 12 m a 0.08888889 0.4211186 10 0.0080987654 1.163179e-05 ## 13 a j 0.03030303 0.4211186 50 0.0005876951 6.125097e-08 ## 14 j j 0.56565657 0.4211186 50 0.0049137843 4.281944e-06 ## 15 m j 0.40404040 0.4211186 50 0.0048158351 4.112936e-06 ## 16 a p 0.16666667 0.4211186 60 0.0023148148 9.502574e-07 ## 17 j p 0.16666667 0.4211186 60 0.0023148148 9.502574e-07 ## 18 m p 0.66666667 0.4211186 60 0.0037037037 2.432659e-06 ## 19 a a 0.90000000 0.4407004 10 0.0090000000 1.573156e-05 ## 20 j a 0.06666667 0.4407004 10 0.0062222222 7.519308e-06 ## 21 m a 0.08888889 0.4407004 10 0.0080987654 1.273868e-05 ## 22 a j 0.03030303 0.4407004 50 0.0005876951 6.707968e-08 ## 23 j j 0.56565657 0.4407004 50 0.0049137843 4.689419e-06 ## 24 m j 0.40404040 0.4407004 50 0.0048158351 4.504328e-06 ## 25 a p 0.16666667 0.4407004 60 0.0023148148 1.040685e-06 ## 26 j p 0.16666667 0.4407004 60 0.0023148148 1.040685e-06 ## 27 m p 0.66666667 0.4407004 60 0.0037037037 2.664154e-06 ## 28 a a 0.90000000 0.2088967 10 0.0090000000 3.534664e-06 ## 29 j a 0.06666667 0.2088967 10 0.0062222222 1.689484e-06 ## 30 m a 0.08888889 0.2088967 10 0.0080987654 2.862205e-06 ## 31 a j 0.03030303 0.2088967 50 0.0005876951 1.507188e-08 ## 32 j j 0.56565657 0.2088967 50 0.0049137843 1.053647e-06 ## 33 m j 0.40404040 0.2088967 50 0.0048158351 1.012060e-06 ## 34 a p 0.16666667 0.2088967 60 0.0023148148 2.338275e-07 ## 35 j p 0.16666667 0.2088967 60 0.0023148148 2.338275e-07 ## 36 m p 0.66666667 0.2088967 60 0.0037037037 5.985985e-07 ## 37 a a 0.90000000 0.1657199 10 0.0090000000 2.224511e-06 ## 38 j a 0.06666667 0.1657199 10 0.0062222222 1.063263e-06 ## 39 m a 0.08888889 0.1657199 10 0.0080987654 1.801305e-06 ## 40 a j 0.03030303 0.1657199 50 0.0005876951 9.485359e-09 ## 41 j j 0.56565657 0.1657199 50 0.0049137843 6.631042e-07 ## 42 m j 0.40404040 0.1657199 50 0.0048158351 6.369316e-07 ## 43 a p 0.16666667 0.1657199 60 0.0023148148 1.471574e-07 ## 44 j p 0.16666667 0.1657199 60 0.0023148148 1.471574e-07 ## 45 m p 0.66666667 0.1657199 60 0.0037037037 3.767229e-07 ## 46 a a 0.90000000 0.1734258 10 0.0090000000 2.436198e-06 ## 47 j a 0.06666667 0.1734258 10 0.0062222222 1.164444e-06 ## 48 m a 0.08888889 0.1734258 10 0.0080987654 1.972719e-06 ## 49 a j 0.03030303 0.1734258 50 0.0005876951 1.038800e-08 ## 50 j j 0.56565657 0.1734258 50 0.0049137843 7.262059e-07 ## 51 m j 0.40404040 0.1734258 50 0.0048158351 6.975428e-07 ## 52 a p 0.16666667 0.1734258 60 0.0023148148 1.611611e-07 ## 53 j p 0.16666667 0.1734258 60 0.0023148148 1.611611e-07 ## 54 m p 0.66666667 0.1734258 60 0.0037037037 4.125723e-07 ## 55 a a 0.90000000 0.3655064 10 0.0090000000 1.082119e-05 ## 56 j a 0.06666667 0.3655064 10 0.0062222222 5.172268e-06 ## 57 m a 0.08888889 0.3655064 10 0.0080987654 8.762492e-06 ## 58 a j 0.03030303 0.3655064 50 0.0005876951 4.614176e-08 ## 59 j j 0.56565657 0.3655064 50 0.0049137843 3.225686e-06 ## 60 m j 0.40404040 0.3655064 50 0.0048158351 3.098369e-06 ## 61 a p 0.16666667 0.3655064 60 0.0023148148 7.158507e-07 ## 62 j p 0.16666667 0.3655064 60 0.0023148148 7.158507e-07 ## 63 m p 0.66666667 0.3655064 60 0.0037037037 1.832578e-06 ## 64 a a 0.90000000 0.2899601 10 0.0090000000 6.810224e-06 ## 65 j a 0.06666667 0.2899601 10 0.0062222222 3.255123e-06 ## 66 m a 0.08888889 0.2899601 10 0.0080987654 5.514600e-06 ## 67 a j 0.03030303 0.2899601 50 0.0005876951 2.903893e-08 ## 68 j j 0.56565657 0.2899601 50 0.0049137843 2.030059e-06 ## 69 m j 0.40404040 0.2899601 50 0.0048158351 1.949933e-06 ## 70 a p 0.16666667 0.2899601 60 0.0023148148 4.505146e-07 ## 71 j p 0.16666667 0.2899601 60 0.0023148148 4.505146e-07 ## 72 m p 0.66666667 0.2899601 60 0.0037037037 1.153317e-06 ## 73 a a 0.90000000 0.3034431 10 0.0090000000 7.458293e-06 ## 74 j a 0.06666667 0.3034431 10 0.0062222222 3.564885e-06 ## 75 m a 0.08888889 0.3034431 10 0.0080987654 6.039376e-06 ## 76 a j 0.03030303 0.3034431 50 0.0005876951 3.180231e-08 ## 77 j j 0.56565657 0.3034431 50 0.0049137843 2.223241e-06 ## 78 m j 0.40404040 0.3034431 50 0.0048158351 2.135491e-06 ## 79 a p 0.16666667 0.3034431 60 0.0023148148 4.933861e-07 ## 80 j p 0.16666667 0.3034431 60 0.0023148148 4.933861e-07 ## 81 m p 0.66666667 0.3034431 60 0.0037037037 1.263069e-06 ICupper=lambda(matA)+ 1.96*sqrt(sum(Contribucion_var$Cont_deVar_lambda)) LClower=lambda(matA)- 1.96*sqrt(sum(Contribucion_var$Cont_deVar_lambda)) ICupper ## [1] 1.059125 LClower ## [1] 0.9942409 Uno de los posible errores es aumis que la distribución de los parametros tienen una distribución normal. En el caso de los parametros de la matriz de transición, estos son proporciones y por consecuencia tienen una distribución beta. En el siguiente ejemplo se calcula la varianza de lambda tomando en cuenta la distribución beta de los parametros. El promedio de distribución beta es \\[\\mu = \\frac{\\alpha}{\\alpha+\\beta}\\] y la varianza es \\[ \\sigma^2 = \\frac{\\alpha\\beta}{(\\alpha+\\beta)^2(\\alpha+\\beta+1)}\\] Por consecuencia {} y {} son los parámetros de la distribución beta. \\[\\alpha = \\left(\\frac{(1-\\mu)}{\\sigma^2}-\\frac{1}{\\mu}\\right)\\mu^2\\] y la beta es \\[\\beta = \\alpha\\left(\\frac{1}{\\mu}-1\\right)\\] #install.packages(&quot;remotes&quot;) # Instalar el paquete remotes #remotes::install_github(&quot;pacific-hake/hake-assessment&quot;) # Instalar el paquete hake-assessment **Importante instalar este paquete ANTES de gfiscamutils** #remotes::install_github(&quot;pbs-assess/gfiscamutils&quot;) # Instalar el paquete gfiscamutils library(gfiscamutils) ## Registered S3 method overwritten by &#39;quantmod&#39;: ## method from ## as.zoo.data.frame zoo ## Registered S3 method overwritten by &#39;GGally&#39;: ## method from ## +.gg ggplot2 ## Warning: replacing previous import &#39;ggh4x::guide_axis_logticks&#39; by ## &#39;ggplot2::guide_axis_logticks&#39; when loading &#39;hake&#39; ## Registered S3 methods overwritten by &#39;adehabitatMA&#39;: ## method from ## print.SpatialPixelsDataFrame sp ## print.SpatialPixels sp calc_beta_params(Contribucion_var$p, Contribucion_var$V_aij) ## alpha1 alpha2 alpha3 alpha4 alpha5 alpha6 ## 1.233668e+03 2.410708e+04 1.389092e+04 2.807578e+06 1.798819e+04 2.569607e+04 ## alpha7 alpha8 alpha9 alpha10 alpha11 alpha12 ## 1.555198e+05 1.555198e+05 2.429933e+04 1.233668e+03 2.410708e+04 1.389092e+04 ## alpha13 alpha14 alpha15 alpha16 alpha17 alpha18 ## 2.807578e+06 1.798819e+04 2.569607e+04 1.555198e+05 1.555198e+05 2.429933e+04 ## alpha19 alpha20 alpha21 alpha22 alpha23 alpha24 ## 1.233668e+03 2.410708e+04 1.389092e+04 2.807578e+06 1.798819e+04 2.569607e+04 ## alpha25 alpha26 alpha27 alpha28 alpha29 alpha30 ## 1.555198e+05 1.555198e+05 2.429933e+04 1.233668e+03 2.410708e+04 1.389092e+04 ## alpha31 alpha32 alpha33 alpha34 alpha35 alpha36 ## 2.807578e+06 1.798819e+04 2.569607e+04 1.555198e+05 1.555198e+05 2.429933e+04 ## alpha37 alpha38 alpha39 alpha40 alpha41 alpha42 ## 1.233668e+03 2.410708e+04 1.389092e+04 2.807578e+06 1.798819e+04 2.569607e+04 ## alpha43 alpha44 alpha45 alpha46 alpha47 alpha48 ## 1.555198e+05 1.555198e+05 2.429933e+04 1.233668e+03 2.410708e+04 1.389092e+04 ## alpha49 alpha50 alpha51 alpha52 alpha53 alpha54 ## 2.807578e+06 1.798819e+04 2.569607e+04 1.555198e+05 1.555198e+05 2.429933e+04 ## alpha55 alpha56 alpha57 alpha58 alpha59 alpha60 ## 1.233668e+03 2.410708e+04 1.389092e+04 2.807578e+06 1.798819e+04 2.569607e+04 ## alpha61 alpha62 alpha63 alpha64 alpha65 alpha66 ## 1.555198e+05 1.555198e+05 2.429933e+04 1.233668e+03 2.410708e+04 1.389092e+04 ## alpha67 alpha68 alpha69 alpha70 alpha71 alpha72 ## 2.807578e+06 1.798819e+04 2.569607e+04 1.555198e+05 1.555198e+05 2.429933e+04 ## alpha73 alpha74 alpha75 alpha76 alpha77 alpha78 ## 1.233668e+03 2.410708e+04 1.389092e+04 2.807578e+06 1.798819e+04 2.569607e+04 ## alpha79 alpha80 alpha81 beta1 beta2 beta3 ## 1.555198e+05 1.555198e+05 2.429933e+04 1.370742e+02 3.374991e+05 1.423819e+05 ## beta4 beta5 beta6 beta7 beta8 beta9 ## 8.984250e+07 1.381236e+04 3.790171e+04 7.775992e+05 7.775992e+05 1.214967e+04 ## beta10 beta11 beta12 beta13 beta14 beta15 ## 1.370742e+02 3.374991e+05 1.423819e+05 8.984250e+07 1.381236e+04 3.790171e+04 ## beta16 beta17 beta18 beta19 beta20 beta21 ## 7.775992e+05 7.775992e+05 1.214967e+04 1.370742e+02 3.374991e+05 1.423819e+05 ## beta22 beta23 beta24 beta25 beta26 beta27 ## 8.984250e+07 1.381236e+04 3.790171e+04 7.775992e+05 7.775992e+05 1.214967e+04 ## beta28 beta29 beta30 beta31 beta32 beta33 ## 1.370742e+02 3.374991e+05 1.423819e+05 8.984250e+07 1.381236e+04 3.790171e+04 ## beta34 beta35 beta36 beta37 beta38 beta39 ## 7.775992e+05 7.775992e+05 1.214967e+04 1.370742e+02 3.374991e+05 1.423819e+05 ## beta40 beta41 beta42 beta43 beta44 beta45 ## 8.984250e+07 1.381236e+04 3.790171e+04 7.775992e+05 7.775992e+05 1.214967e+04 ## beta46 beta47 beta48 beta49 beta50 beta51 ## 1.370742e+02 3.374991e+05 1.423819e+05 8.984250e+07 1.381236e+04 3.790171e+04 ## beta52 beta53 beta54 beta55 beta56 beta57 ## 7.775992e+05 7.775992e+05 1.214967e+04 1.370742e+02 3.374991e+05 1.423819e+05 ## beta58 beta59 beta60 beta61 beta62 beta63 ## 8.984250e+07 1.381236e+04 3.790171e+04 7.775992e+05 7.775992e+05 1.214967e+04 ## beta64 beta65 beta66 beta67 beta68 beta69 ## 1.370742e+02 3.374991e+05 1.423819e+05 8.984250e+07 1.381236e+04 3.790171e+04 ## beta70 beta71 beta72 beta73 beta74 beta75 ## 7.775992e+05 7.775992e+05 1.214967e+04 1.370742e+02 3.374991e+05 1.423819e+05 ## beta76 beta77 beta78 beta79 beta80 beta81 ## 8.984250e+07 1.381236e+04 3.790171e+04 7.775992e+05 7.775992e+05 1.214967e+04 bp=calc_beta_params(0.5308370, sqrt(0.09)) bp[1] ## alpha ## 4.682085 bp[2] ## beta ## 4.138109 library(tidyverse) Contribucion_var |&gt; mutate(alpha = calc_beta_params(p, (sqrt(V_aij)))[1], beta = calc_beta_params(p, (sqrt(V_aij)))[2]) |&gt; mutate(mu = alpha/(alpha+beta)) |&gt; mutate(var = alpha*beta/((alpha+beta)^2*(alpha+beta+1))) ## Var1 Var2 p Sensitividad N V_aij Cont_deVar_lambda alpha ## 1 a a 0.90000000 0.5308370 10 0.0090000000 2.282482e-05 10.21111 ## 2 j a 0.06666667 0.5308370 10 0.0062222222 1.090971e-05 10.21111 ## 3 m a 0.08888889 0.5308370 10 0.0080987654 1.848247e-05 10.21111 ## 4 a j 0.03030303 0.5308370 50 0.0005876951 9.732548e-08 10.21111 ## 5 j j 0.56565657 0.5308370 50 0.0049137843 6.803847e-06 10.21111 ## 6 m j 0.40404040 0.5308370 50 0.0048158351 6.535301e-06 10.21111 ## 7 a p 0.16666667 0.5308370 60 0.0023148148 1.509923e-06 10.21111 ## 8 j p 0.16666667 0.5308370 60 0.0023148148 1.509923e-06 10.21111 ## 9 m p 0.66666667 0.5308370 60 0.0037037037 3.865403e-06 10.21111 ## 10 a a 0.90000000 0.4211186 10 0.0090000000 1.436461e-05 10.21111 ## 11 j a 0.06666667 0.4211186 10 0.0062222222 6.865937e-06 10.21111 ## 12 m a 0.08888889 0.4211186 10 0.0080987654 1.163179e-05 10.21111 ## 13 a j 0.03030303 0.4211186 50 0.0005876951 6.125097e-08 10.21111 ## 14 j j 0.56565657 0.4211186 50 0.0049137843 4.281944e-06 10.21111 ## 15 m j 0.40404040 0.4211186 50 0.0048158351 4.112936e-06 10.21111 ## 16 a p 0.16666667 0.4211186 60 0.0023148148 9.502574e-07 10.21111 ## 17 j p 0.16666667 0.4211186 60 0.0023148148 9.502574e-07 10.21111 ## 18 m p 0.66666667 0.4211186 60 0.0037037037 2.432659e-06 10.21111 ## 19 a a 0.90000000 0.4407004 10 0.0090000000 1.573156e-05 10.21111 ## 20 j a 0.06666667 0.4407004 10 0.0062222222 7.519308e-06 10.21111 ## 21 m a 0.08888889 0.4407004 10 0.0080987654 1.273868e-05 10.21111 ## 22 a j 0.03030303 0.4407004 50 0.0005876951 6.707968e-08 10.21111 ## 23 j j 0.56565657 0.4407004 50 0.0049137843 4.689419e-06 10.21111 ## 24 m j 0.40404040 0.4407004 50 0.0048158351 4.504328e-06 10.21111 ## 25 a p 0.16666667 0.4407004 60 0.0023148148 1.040685e-06 10.21111 ## 26 j p 0.16666667 0.4407004 60 0.0023148148 1.040685e-06 10.21111 ## 27 m p 0.66666667 0.4407004 60 0.0037037037 2.664154e-06 10.21111 ## 28 a a 0.90000000 0.2088967 10 0.0090000000 3.534664e-06 10.21111 ## 29 j a 0.06666667 0.2088967 10 0.0062222222 1.689484e-06 10.21111 ## 30 m a 0.08888889 0.2088967 10 0.0080987654 2.862205e-06 10.21111 ## 31 a j 0.03030303 0.2088967 50 0.0005876951 1.507188e-08 10.21111 ## 32 j j 0.56565657 0.2088967 50 0.0049137843 1.053647e-06 10.21111 ## 33 m j 0.40404040 0.2088967 50 0.0048158351 1.012060e-06 10.21111 ## 34 a p 0.16666667 0.2088967 60 0.0023148148 2.338275e-07 10.21111 ## 35 j p 0.16666667 0.2088967 60 0.0023148148 2.338275e-07 10.21111 ## 36 m p 0.66666667 0.2088967 60 0.0037037037 5.985985e-07 10.21111 ## 37 a a 0.90000000 0.1657199 10 0.0090000000 2.224511e-06 10.21111 ## 38 j a 0.06666667 0.1657199 10 0.0062222222 1.063263e-06 10.21111 ## 39 m a 0.08888889 0.1657199 10 0.0080987654 1.801305e-06 10.21111 ## 40 a j 0.03030303 0.1657199 50 0.0005876951 9.485359e-09 10.21111 ## 41 j j 0.56565657 0.1657199 50 0.0049137843 6.631042e-07 10.21111 ## 42 m j 0.40404040 0.1657199 50 0.0048158351 6.369316e-07 10.21111 ## 43 a p 0.16666667 0.1657199 60 0.0023148148 1.471574e-07 10.21111 ## 44 j p 0.16666667 0.1657199 60 0.0023148148 1.471574e-07 10.21111 ## 45 m p 0.66666667 0.1657199 60 0.0037037037 3.767229e-07 10.21111 ## 46 a a 0.90000000 0.1734258 10 0.0090000000 2.436198e-06 10.21111 ## 47 j a 0.06666667 0.1734258 10 0.0062222222 1.164444e-06 10.21111 ## 48 m a 0.08888889 0.1734258 10 0.0080987654 1.972719e-06 10.21111 ## 49 a j 0.03030303 0.1734258 50 0.0005876951 1.038800e-08 10.21111 ## 50 j j 0.56565657 0.1734258 50 0.0049137843 7.262059e-07 10.21111 ## 51 m j 0.40404040 0.1734258 50 0.0048158351 6.975428e-07 10.21111 ## 52 a p 0.16666667 0.1734258 60 0.0023148148 1.611611e-07 10.21111 ## 53 j p 0.16666667 0.1734258 60 0.0023148148 1.611611e-07 10.21111 ## 54 m p 0.66666667 0.1734258 60 0.0037037037 4.125723e-07 10.21111 ## 55 a a 0.90000000 0.3655064 10 0.0090000000 1.082119e-05 10.21111 ## 56 j a 0.06666667 0.3655064 10 0.0062222222 5.172268e-06 10.21111 ## 57 m a 0.08888889 0.3655064 10 0.0080987654 8.762492e-06 10.21111 ## 58 a j 0.03030303 0.3655064 50 0.0005876951 4.614176e-08 10.21111 ## 59 j j 0.56565657 0.3655064 50 0.0049137843 3.225686e-06 10.21111 ## 60 m j 0.40404040 0.3655064 50 0.0048158351 3.098369e-06 10.21111 ## 61 a p 0.16666667 0.3655064 60 0.0023148148 7.158507e-07 10.21111 ## 62 j p 0.16666667 0.3655064 60 0.0023148148 7.158507e-07 10.21111 ## 63 m p 0.66666667 0.3655064 60 0.0037037037 1.832578e-06 10.21111 ## 64 a a 0.90000000 0.2899601 10 0.0090000000 6.810224e-06 10.21111 ## 65 j a 0.06666667 0.2899601 10 0.0062222222 3.255123e-06 10.21111 ## 66 m a 0.08888889 0.2899601 10 0.0080987654 5.514600e-06 10.21111 ## 67 a j 0.03030303 0.2899601 50 0.0005876951 2.903893e-08 10.21111 ## 68 j j 0.56565657 0.2899601 50 0.0049137843 2.030059e-06 10.21111 ## 69 m j 0.40404040 0.2899601 50 0.0048158351 1.949933e-06 10.21111 ## 70 a p 0.16666667 0.2899601 60 0.0023148148 4.505146e-07 10.21111 ## 71 j p 0.16666667 0.2899601 60 0.0023148148 4.505146e-07 10.21111 ## 72 m p 0.66666667 0.2899601 60 0.0037037037 1.153317e-06 10.21111 ## 73 a a 0.90000000 0.3034431 10 0.0090000000 7.458293e-06 10.21111 ## 74 j a 0.06666667 0.3034431 10 0.0062222222 3.564885e-06 10.21111 ## 75 m a 0.08888889 0.3034431 10 0.0080987654 6.039376e-06 10.21111 ## 76 a j 0.03030303 0.3034431 50 0.0005876951 3.180231e-08 10.21111 ## 77 j j 0.56565657 0.3034431 50 0.0049137843 2.223241e-06 10.21111 ## 78 m j 0.40404040 0.3034431 50 0.0048158351 2.135491e-06 10.21111 ## 79 a p 0.16666667 0.3034431 60 0.0023148148 4.933861e-07 10.21111 ## 80 j p 0.16666667 0.3034431 60 0.0023148148 4.933861e-07 10.21111 ## 81 m p 0.66666667 0.3034431 60 0.0037037037 1.263069e-06 10.21111 ## beta mu var ## 1 149.9333 0.06376188 0.0003704521 ## 2 149.9333 0.06376188 0.0003704521 ## 3 149.9333 0.06376188 0.0003704521 ## 4 149.9333 0.06376188 0.0003704521 ## 5 149.9333 0.06376188 0.0003704521 ## 6 149.9333 0.06376188 0.0003704521 ## 7 149.9333 0.06376188 0.0003704521 ## 8 149.9333 0.06376188 0.0003704521 ## 9 149.9333 0.06376188 0.0003704521 ## 10 149.9333 0.06376188 0.0003704521 ## 11 149.9333 0.06376188 0.0003704521 ## 12 149.9333 0.06376188 0.0003704521 ## 13 149.9333 0.06376188 0.0003704521 ## 14 149.9333 0.06376188 0.0003704521 ## 15 149.9333 0.06376188 0.0003704521 ## 16 149.9333 0.06376188 0.0003704521 ## 17 149.9333 0.06376188 0.0003704521 ## 18 149.9333 0.06376188 0.0003704521 ## 19 149.9333 0.06376188 0.0003704521 ## 20 149.9333 0.06376188 0.0003704521 ## 21 149.9333 0.06376188 0.0003704521 ## 22 149.9333 0.06376188 0.0003704521 ## 23 149.9333 0.06376188 0.0003704521 ## 24 149.9333 0.06376188 0.0003704521 ## 25 149.9333 0.06376188 0.0003704521 ## 26 149.9333 0.06376188 0.0003704521 ## 27 149.9333 0.06376188 0.0003704521 ## 28 149.9333 0.06376188 0.0003704521 ## 29 149.9333 0.06376188 0.0003704521 ## 30 149.9333 0.06376188 0.0003704521 ## 31 149.9333 0.06376188 0.0003704521 ## 32 149.9333 0.06376188 0.0003704521 ## 33 149.9333 0.06376188 0.0003704521 ## 34 149.9333 0.06376188 0.0003704521 ## 35 149.9333 0.06376188 0.0003704521 ## 36 149.9333 0.06376188 0.0003704521 ## 37 149.9333 0.06376188 0.0003704521 ## 38 149.9333 0.06376188 0.0003704521 ## 39 149.9333 0.06376188 0.0003704521 ## 40 149.9333 0.06376188 0.0003704521 ## 41 149.9333 0.06376188 0.0003704521 ## 42 149.9333 0.06376188 0.0003704521 ## 43 149.9333 0.06376188 0.0003704521 ## 44 149.9333 0.06376188 0.0003704521 ## 45 149.9333 0.06376188 0.0003704521 ## 46 149.9333 0.06376188 0.0003704521 ## 47 149.9333 0.06376188 0.0003704521 ## 48 149.9333 0.06376188 0.0003704521 ## 49 149.9333 0.06376188 0.0003704521 ## 50 149.9333 0.06376188 0.0003704521 ## 51 149.9333 0.06376188 0.0003704521 ## 52 149.9333 0.06376188 0.0003704521 ## 53 149.9333 0.06376188 0.0003704521 ## 54 149.9333 0.06376188 0.0003704521 ## 55 149.9333 0.06376188 0.0003704521 ## 56 149.9333 0.06376188 0.0003704521 ## 57 149.9333 0.06376188 0.0003704521 ## 58 149.9333 0.06376188 0.0003704521 ## 59 149.9333 0.06376188 0.0003704521 ## 60 149.9333 0.06376188 0.0003704521 ## 61 149.9333 0.06376188 0.0003704521 ## 62 149.9333 0.06376188 0.0003704521 ## 63 149.9333 0.06376188 0.0003704521 ## 64 149.9333 0.06376188 0.0003704521 ## 65 149.9333 0.06376188 0.0003704521 ## 66 149.9333 0.06376188 0.0003704521 ## 67 149.9333 0.06376188 0.0003704521 ## 68 149.9333 0.06376188 0.0003704521 ## 69 149.9333 0.06376188 0.0003704521 ## 70 149.9333 0.06376188 0.0003704521 ## 71 149.9333 0.06376188 0.0003704521 ## 72 149.9333 0.06376188 0.0003704521 ## 73 149.9333 0.06376188 0.0003704521 ## 74 149.9333 0.06376188 0.0003704521 ## 75 149.9333 0.06376188 0.0003704521 ## 76 149.9333 0.06376188 0.0003704521 ## 77 149.9333 0.06376188 0.0003704521 ## 78 149.9333 0.06376188 0.0003704521 ## 79 149.9333 0.06376188 0.0003704521 ## 80 149.9333 0.06376188 0.0003704521 ## 81 149.9333 0.06376188 0.0003704521 calc_beta_params(0.9, sqrt(0.009)) ## alpha beta ## 10.211111 1.134568 ss=Contribucion_var[1,] calc_beta_params(ss$p, sqrt(ss$V_aij)) ## alpha beta ## 10.211111 1.134568 mutate(mu = alpha/(alpha+beta)) |&gt; mutate(var = alpha*beta/((alpha+beta)^2*(alpha+beta+1))) |&gt; mutate(V_aij = (mu*(1-mu)/N)) |&gt; mutate(Cont_deVar_lambda = (Sensitividad^2)*V_aij^2) # Calcular la contribución de la varianza de cada parámetro a lambda estBetaParams &lt;- function(mu, var) { alpha &lt;- ((1 - mu) / var - 1 / mu) * mu ^ 2 beta &lt;- alpha * (1 / mu - 1) return(params = list(alpha = alpha, beta = beta)) } Los paramétros de una beta son \\(\\alpha\\) y \\(\\beta\\), La varianza de una beta es \\(\\alpha\\beta/(\\alpha+\\beta)^2(\\alpha+\\beta+1)\\). En el siguiente ejemplo se calcula la varianza de lambda tomando en cuenta la distribución beta de los parametros. References Ebert, thomas A. 1999. Plant and Animal Populations. Methods in Demography. Academic Press. "],["install.html", "Capítulo 25 install.packages(“bbmle”)", " Capítulo 25 install.packages(“bbmle”) library(“bbmle”) x &lt;- rep(1, length(my.probs)) y &lt;- rep(1, length(my.probs)) my.model &lt;- mle2(minuslogl = my.probs ~ dbeta(shape1, shape2), start = list(shape1 = 2, shape2 = 30), data = data.frame(x, y)) # There were 12 warnings (use warnings() to see them) summary(my.model) Ebert, thomas A. 1999. Plant and Animal Populations. Methods in Demography. Academic Press. "]]
