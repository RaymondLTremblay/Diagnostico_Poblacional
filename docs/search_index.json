[["compadre_orchid-ppm-y-su-uso.html", "Capítulo 17 Compadre_Orchid PPM y su uso 17.1 Para tener acceso a los datos cuando no esta conectado al internet es necesario bajar el archivo y instalar en su proyecto de RStudio. Al momento de construir el libro la versión meas reciente de COMPADRE es la versión 6.23.5.5.0 (May_06_2023) y se puede bajar al siguiente enlace &lt;&lt;https://compadre-db.org/Data/Compadre/COMPADRE_v. 17.2 Contabilizar cuantas matrices y variables estan incluidas en el archivo 17.3 ROBERTO: 17.4 Cuantos estudios unicos? 17.5 Important to include only matrices that are annual.", " Capítulo 17 Compadre_Orchid PPM y su uso Raymond y Roberto Activar los siguiente paquetes library(Rcompadre) # Paquete para trabajar con la base de datos de COMPADRE y COMADRE library(tidyverse) library(gt) library(kableExtra) 17.0.1 COMPADRE Este capítulo es una introducción a COMPADRE y algunas de la funciones en los paquetes de Rcompadre y Rage. La información aqui no sustituye la información proviste &lt;https://compadre-db.org/&gt; y los tutoriales que se encuentran en la siguiente pagina &lt;https://compadre-db.org/Education&gt; 17.0.2 Acceso a los datos de COMPADRE. Hay dos métodos de tener acceso a los datos de COMPADRE (datos de dinamica poblacional de plantas) y COMADRE (datos de dinamica poblacional de animales). Los datos se pueden acesar directamente en la pagina de web o bajar el archivo de datos al siguiente enlace &lt;https://compadre-db.org/Data/Compadre&gt; seleccionando la pestaña de Download COMPADRE. 17.1 Para tener acceso a los datos cuando no esta conectado al internet es necesario bajar el archivo y instalar en su proyecto de RStudio. Al momento de construir el libro la versión meas reciente de COMPADRE es la versión 6.23.5.5.0 (May_06_2023) y se puede bajar al siguiente enlace &lt;&lt;https://compadre-db.org/Data/Compadre/COMPADRE_v. Usando la función cdb_fetch() se puede bajar los datos directamente de la pagina de web de COMPADRE. compadre &lt;- cdb_fetch(&quot;compadre&quot;) # Usar este código para bajar los datos del repositorio de COMPADRE. ## This is COMPADRE version 6.23.5.0 (release date May_06_2023) ## See user agreement at https://compadre-db.org/Help/UserAgreement ## See how to cite with `citation(Rcompadre)` # USAR el código siguiente si tiene los datos bajado a su computadora. # load(dirección al archivo a su proyecto de RStudio) si tiene el repositorio en su computadora 17.1.0.1 Renombrar la base datos algo sencillo En este script se renombrar la base de datos de COMPADRE a algo más sencillo TodasSp, como compadre. Se visualiza el nombre de cada columna en la base de datos. Hay 59 variables en la base de datos de COMPADRE. #TodasSp=as_cdb(compadre) # Un paso critico: Convertir la base de datos anterior COM(P)ADRE (de clase &#39;list&#39;) en la base en un objeto CompadreDB (COMPADRE Database) TodasSp=compadre names(TodasSp) # La lista de los nombres de las variables en el archivo COMPADRE ## [1] &quot;mat&quot; &quot;MatrixID&quot; &quot;SpeciesAuthor&quot; ## [4] &quot;SpeciesAccepted&quot; &quot;CommonName&quot; &quot;Kingdom&quot; ## [7] &quot;Phylum&quot; &quot;Class&quot; &quot;Order&quot; ## [10] &quot;Family&quot; &quot;Genus&quot; &quot;Species&quot; ## [13] &quot;Infraspecies&quot; &quot;InfraspeciesType&quot; &quot;OrganismType&quot; ## [16] &quot;DicotMonoc&quot; &quot;AngioGymno&quot; &quot;Authors&quot; ## [19] &quot;Journal&quot; &quot;SourceType&quot; &quot;OtherType&quot; ## [22] &quot;YearPublication&quot; &quot;DOI_ISBN&quot; &quot;AdditionalSource&quot; ## [25] &quot;StudyDuration&quot; &quot;StudyStart&quot; &quot;StudyEnd&quot; ## [28] &quot;ProjectionInterval&quot; &quot;MatrixCriteriaSize&quot; &quot;MatrixCriteriaOntogeny&quot; ## [31] &quot;MatrixCriteriaAge&quot; &quot;MatrixPopulation&quot; &quot;NumberPopulations&quot; ## [34] &quot;Lat&quot; &quot;Lon&quot; &quot;Altitude&quot; ## [37] &quot;Country&quot; &quot;Continent&quot; &quot;Ecoregion&quot; ## [40] &quot;StudiedSex&quot; &quot;MatrixComposite&quot; &quot;MatrixSeasonal&quot; ## [43] &quot;MatrixTreatment&quot; &quot;MatrixCaptivity&quot; &quot;MatrixStartYear&quot; ## [46] &quot;MatrixStartSeason&quot; &quot;MatrixStartMonth&quot; &quot;MatrixEndYear&quot; ## [49] &quot;MatrixEndSeason&quot; &quot;MatrixEndMonth&quot; &quot;CensusType&quot; ## [52] &quot;MatrixSplit&quot; &quot;MatrixFec&quot; &quot;Observations&quot; ## [55] &quot;MatrixDimension&quot; &quot;SurvivalIssue&quot; &quot;_Database&quot; ## [58] &quot;_PopulationStatus&quot; &quot;_PublicationStatus&quot; 17.1.0.2 Evaluate if a genus/species are present in the data base Para filtrar para un genero específico se puede usar el siguiente código. Aquí seleccionamos todas las matrices del genero Epipactis. Nota que hay 59 filas, que corresponde tipicamente a 59 matrices de diferentes poblaciones, tiempo o un análisis teóricos. Epi = TodasSp %&gt;% filter(Genus %in% c(&quot;Epipactis&quot;)) Epi # This shows that the species added Epidendrum xanthinum is not yet included in the data base ## A COM(P)ADRE database (&#39;CompadreDB&#39;) object with 1 SPECIES and 51 MATRICES. ## ## # A tibble: 51 × 59 ## mat MatrixID SpeciesAuthor SpeciesAccepted CommonName Kingdom Phylum ## &lt;list&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; ## 1 &lt;CompdrMt&gt; 238565 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach… ## 2 &lt;CompdrMt&gt; 238566 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach… ## 3 &lt;CompdrMt&gt; 238568 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach… ## 4 &lt;CompdrMt&gt; 238569 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach… ## 5 &lt;CompdrMt&gt; 238570 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach… ## 6 &lt;CompdrMt&gt; 238574 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach… ## 7 &lt;CompdrMt&gt; 238575 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach… ## 8 &lt;CompdrMt&gt; 238576 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach… ## 9 &lt;CompdrMt&gt; 242965 Epipactis_atro… Epipactis atro… Darkred h… Plantae Magno… ## 10 &lt;CompdrMt&gt; 242966 Epipactis_atro… Epipactis atro… Darkred h… Plantae Magno… ## # ℹ 41 more rows ## # ℹ 52 more variables: Class &lt;chr&gt;, Order &lt;chr&gt;, Family &lt;chr&gt;, Genus &lt;chr&gt;, ## # Species &lt;chr&gt;, Infraspecies &lt;chr&gt;, InfraspeciesType &lt;chr&gt;, ## # OrganismType &lt;chr&gt;, DicotMonoc &lt;chr&gt;, AngioGymno &lt;chr&gt;, Authors &lt;chr&gt;, ## # Journal &lt;chr&gt;, SourceType &lt;chr&gt;, OtherType &lt;chr&gt;, YearPublication &lt;chr&gt;, ## # DOI_ISBN &lt;chr&gt;, AdditionalSource &lt;chr&gt;, StudyDuration &lt;chr&gt;, ## # StudyStart &lt;chr&gt;, StudyEnd &lt;chr&gt;, ProjectionInterval &lt;chr&gt;, … 17.1.1 Filtrar para la familia de Orquidaceae Extraer (filter) solamente las especies de la familia Orchidaceae index_O=TodasSp %&gt;% filter(Family %in% c(&quot;Orchidaceae&quot;)) # Extraer la orquídeas de la base de datos. head(index_O, n=3) ## A COM(P)ADRE database (&#39;CompadreDB&#39;) object with 3 SPECIES and 3 MATRICES. ## ## # A tibble: 3 × 59 ## mat MatrixID SpeciesAuthor SpeciesAccepted CommonName Kingdom Phylum ## &lt;list&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; ## 1 &lt;CompdrMt&gt; 238285 Caladenia_amonea Caladenia amon… &lt;NA&gt; Plantae Trach… ## 2 &lt;CompdrMt&gt; 238286 Caladenia_argoc… Caladenia argo… &lt;NA&gt; Plantae Trach… ## 3 &lt;CompdrMt&gt; 238287 Caladenia_clavi… Caladenia clav… &lt;NA&gt; Plantae Trach… ## # ℹ 52 more variables: Class &lt;chr&gt;, Order &lt;chr&gt;, Family &lt;chr&gt;, Genus &lt;chr&gt;, ## # Species &lt;chr&gt;, Infraspecies &lt;chr&gt;, InfraspeciesType &lt;chr&gt;, ## # OrganismType &lt;chr&gt;, DicotMonoc &lt;chr&gt;, AngioGymno &lt;chr&gt;, Authors &lt;chr&gt;, ## # Journal &lt;chr&gt;, SourceType &lt;chr&gt;, OtherType &lt;chr&gt;, YearPublication &lt;chr&gt;, ## # DOI_ISBN &lt;chr&gt;, AdditionalSource &lt;chr&gt;, StudyDuration &lt;chr&gt;, ## # StudyStart &lt;chr&gt;, StudyEnd &lt;chr&gt;, ProjectionInterval &lt;chr&gt;, ## # MatrixCriteriaSize &lt;chr&gt;, MatrixCriteriaOntogeny &lt;chr&gt;, … 17.1.2 Los géneros de la familia Orchidaceae Cual son los géneros de la familia Orquidaceae incluidos en la base de datos de COMPADRE? se usa la función unique() para seleccionar los géneros únicos en la base de datos. se crea un data frame con los géneros únicos. Genera=(as.data.frame(sort(unique(index_O$Genus)))) gt(Genera) #eqczcfobym table { font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; } #eqczcfobym thead, #eqczcfobym tbody, #eqczcfobym tfoot, #eqczcfobym tr, #eqczcfobym td, #eqczcfobym th { border-style: none; } #eqczcfobym p { margin: 0; padding: 0; } #eqczcfobym .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #eqczcfobym .gt_caption { padding-top: 4px; padding-bottom: 4px; } #eqczcfobym .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #eqczcfobym .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #eqczcfobym .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #eqczcfobym .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #eqczcfobym .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #eqczcfobym .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #eqczcfobym .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #eqczcfobym .gt_column_spanner_outer:first-child { padding-left: 0; } #eqczcfobym .gt_column_spanner_outer:last-child { padding-right: 0; } #eqczcfobym .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #eqczcfobym .gt_spanner_row { border-bottom-style: hidden; } #eqczcfobym .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; } #eqczcfobym .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #eqczcfobym .gt_from_md > :first-child { margin-top: 0; } #eqczcfobym .gt_from_md > :last-child { margin-bottom: 0; } #eqczcfobym .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #eqczcfobym .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; } #eqczcfobym .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; } #eqczcfobym .gt_row_group_first td { border-top-width: 2px; } #eqczcfobym .gt_row_group_first th { border-top-width: 2px; } #eqczcfobym .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #eqczcfobym .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #eqczcfobym .gt_first_summary_row.thick { border-top-width: 2px; } #eqczcfobym .gt_last_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #eqczcfobym .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #eqczcfobym .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #eqczcfobym .gt_last_grand_summary_row_top { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: double; border-bottom-width: 6px; border-bottom-color: #D3D3D3; } #eqczcfobym .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #eqczcfobym .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #eqczcfobym .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #eqczcfobym .gt_footnote { margin: 0px; font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #eqczcfobym .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #eqczcfobym .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #eqczcfobym .gt_left { text-align: left; } #eqczcfobym .gt_center { text-align: center; } #eqczcfobym .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #eqczcfobym .gt_font_normal { font-weight: normal; } #eqczcfobym .gt_font_bold { font-weight: bold; } #eqczcfobym .gt_font_italic { font-style: italic; } #eqczcfobym .gt_super { font-size: 65%; } #eqczcfobym .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; } #eqczcfobym .gt_asterisk { font-size: 100%; vertical-align: 0; } #eqczcfobym .gt_indent_1 { text-indent: 5px; } #eqczcfobym .gt_indent_2 { text-indent: 10px; } #eqczcfobym .gt_indent_3 { text-indent: 15px; } #eqczcfobym .gt_indent_4 { text-indent: 20px; } #eqczcfobym .gt_indent_5 { text-indent: 25px; } sort(unique(index_O$Genus)) Aspasia Brassavola Broughtonia Caladenia Cephalanthera Cleistes Cleistesiopsis Corallorhiza Cypripedium Dactylorhiza Dendrophylax Epipactis Erycina Guarianthe Herminium Himantoglossum Jacquiniella Lepanthes Lycaste Neotinea Oeceoclades Oncidium Ophrys Orchis Platanthera Serapias Spathoglottis Telipogon Tolumnia 17.1.3 Lista de especies únicas de orquídeas en la base de datos de COMPADRE. Cual son las especies únicas de la familia Orquidaceae incluidos en la base de datos de COMPADRE? se usa la función unique() para seleccionar las especies únicas en la base de datos con la variable SpeciesAccepted. se crea un data frame con las especies únicas. Note que al momento hay 46 especies con nombres únicos en la base de datos gt(as.data.frame(sort(unique(index_O$SpeciesAccepted)))) #lhftqmstcy table { font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; } #lhftqmstcy thead, #lhftqmstcy tbody, #lhftqmstcy tfoot, #lhftqmstcy tr, #lhftqmstcy td, #lhftqmstcy th { border-style: none; } #lhftqmstcy p { margin: 0; padding: 0; } #lhftqmstcy .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #lhftqmstcy .gt_caption { padding-top: 4px; padding-bottom: 4px; } #lhftqmstcy .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #lhftqmstcy .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #lhftqmstcy .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #lhftqmstcy .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #lhftqmstcy .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #lhftqmstcy .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #lhftqmstcy .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #lhftqmstcy .gt_column_spanner_outer:first-child { padding-left: 0; } #lhftqmstcy .gt_column_spanner_outer:last-child { padding-right: 0; } #lhftqmstcy .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #lhftqmstcy .gt_spanner_row { border-bottom-style: hidden; } #lhftqmstcy .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; } #lhftqmstcy .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #lhftqmstcy .gt_from_md > :first-child { margin-top: 0; } #lhftqmstcy .gt_from_md > :last-child { margin-bottom: 0; } #lhftqmstcy .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #lhftqmstcy .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; } #lhftqmstcy .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; } #lhftqmstcy .gt_row_group_first td { border-top-width: 2px; } #lhftqmstcy .gt_row_group_first th { border-top-width: 2px; } #lhftqmstcy .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #lhftqmstcy .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #lhftqmstcy .gt_first_summary_row.thick { border-top-width: 2px; } #lhftqmstcy .gt_last_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #lhftqmstcy .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #lhftqmstcy .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #lhftqmstcy .gt_last_grand_summary_row_top { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: double; border-bottom-width: 6px; border-bottom-color: #D3D3D3; } #lhftqmstcy .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #lhftqmstcy .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #lhftqmstcy .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #lhftqmstcy .gt_footnote { margin: 0px; font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #lhftqmstcy .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #lhftqmstcy .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #lhftqmstcy .gt_left { text-align: left; } #lhftqmstcy .gt_center { text-align: center; } #lhftqmstcy .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #lhftqmstcy .gt_font_normal { font-weight: normal; } #lhftqmstcy .gt_font_bold { font-weight: bold; } #lhftqmstcy .gt_font_italic { font-style: italic; } #lhftqmstcy .gt_super { font-size: 65%; } #lhftqmstcy .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; } #lhftqmstcy .gt_asterisk { font-size: 100%; vertical-align: 0; } #lhftqmstcy .gt_indent_1 { text-indent: 5px; } #lhftqmstcy .gt_indent_2 { text-indent: 10px; } #lhftqmstcy .gt_indent_3 { text-indent: 15px; } #lhftqmstcy .gt_indent_4 { text-indent: 20px; } #lhftqmstcy .gt_indent_5 { text-indent: 25px; } sort(unique(index_O$SpeciesAccepted)) Aspasia principissa Brassavola cucullata Broughtonia cubensis Caladenia amonea Caladenia argocalla Caladenia clavigera Caladenia elegans Caladenia graniticola Caladenia macroclavia Caladenia oenochila Caladenia rosella Caladenia valida Cephalanthera longifolia Cleistes bifaria Cleistesiopsis bifaria Cleistesiopsis divaricata Corallorhiza trifida Cypripedium calceolus Cypripedium fasciculatum Cypripedium lentiginosum Cypripedium parviflorum Dactylorhiza lapponica Dendrophylax lindenii Epipactis atrorubens Erycina crista-galli Guarianthe aurantiaca Herminium monorchis Himantoglossum hircinum Jacquiniella leucomelana Jacquiniella teretifolia Lepanthes acuminata Lepanthes caritensis Lepanthes eltoroensis Lepanthes rubripetala Lepanthes rupestris Lycaste aromatica Neotinea ustulata Oeceoclades maculata Oncidium poikilostalix Ophrys sphegodes Orchis purpurea Platanthera hookeri Serapias cordigera Spathoglottis plicata Telipogon helleri Tolumnia variegata 17.2 Contabilizar cuantas matrices y variables estan incluidas en el archivo La base de datos de orquídea tiene un total de 647 filas con 59 variables, por consecuencia tiene 647 matrices. Esas matrices de la misma especie son de diferentes poblaciones, tiempo o un análisis teóricos. dim(index_O) ## [1] 647 59 17.2.1 La fuente de la información Para saber de cuantos manuscritos distintos provienen esos datos uno puede evaluar la cantidad de DOI_ISBN distintos. En este caso los de esas 647 matrices provienen de 34 fuentes de información publicada, revisada por pares, tesis o informes técnicos. unique(index_O$DOI_ISBN) ## [1] &quot;10.1071/BT08167&quot; ## [2] &quot;10.1016/j.biocon.2017.04.019&quot; ## [3] &quot;10.1007/s10531-009-9724-1&quot; ## [4] &quot;10.1007/s10530-016-1318-8&quot; ## [5] &quot;10.1111/btp.12231&quot; ## [6] &quot;10.1890/ES11-00328.1&quot; ## [7] &quot;10.1016/j.biocon.2005.09.044&quot; ## [8] &quot;10.1111/boj.12204&quot; ## [9] &quot;10.1080/17550874.2018.1444110&quot; ## [10] &quot;10.1002/1438-390X.1002&quot; ## [11] NA ## [12] &quot;10.1093/aob/mcv031&quot; ## [13] &quot;10.1080/17550874.2017.1315840&quot; ## [14] &quot;10.1016/j.biocon.2005.07.022&quot; ## [15] &quot;10.1111/j.1442-1984.2009.00230.x&quot; ## [16] &quot;10.1093/aob/mcp188&quot; ## [17] &quot;10.1006/bijl.2000.0485&quot; ## [18] &quot;10.2307/1940473&quot; ## [19] &quot;90-5103-068-1&quot; ## [20] &quot;978-84-8014-746-0&quot; ## [21] &quot;10.1111/j.1365-2745.2005.01010.x&quot; ## [22] &quot;10.1111/j.1523-1739.2010.01466.x&quot; ## [23] &quot;10.1016/S1872-2032(08)60021-9&quot; ## [24] &quot;10.1111/1365-2745.12281&quot; ## [25] &quot;10.1016/j.biocon.2009.12.017&quot; ## [26] &quot;10.1111/gcb.12167&quot; ## [27] &quot;10.1890/10-1957.1&quot; ## [28] &quot;10.1111/j.1095-8339.1998.tb02514.x&quot; ## [29] &quot;10.1111/j.1365-2664.2006.01148.x&quot; ## [30] &quot;10.1371/journal.pone.0102859&quot; ## [31] &quot;10.1111/j.1365-2745.2006.01195.x&quot; ## [32] &quot;10.1890/08-2321.1&quot; ## [33] &quot;10.3159/1095-5674(2007)134[369:PEOPHO]2.0.CO;2&quot; ## [34] &quot;10.1007/s10530-019-01945-7&quot; Igualmente podemos evaluar cuantos distintos autores son responsable de esas publicaciones. Un total de 37 autores únicos o en grupo son la fuente de esos artículos. 17.3 ROBERTO: HAY una manera de contabilizar los nombres específicos, no por grupo? Para saber quien más publica sobre orquídeas. unique(index_O$Authors) ## [1] &quot;Tremblay; Pérez; Larcombe; Brown; Quarmby; Bickerton; French; Bould&quot; ## [2] &quot;Hens; Pakanen; Jäkäläniemi; Tuomi; Kvist&quot; ## [3] &quot;Schödelbauerová; Tremblay; Kindlmann&quot; ## [4] &quot;Falcón; Ackerman; Tremblay&quot; ## [5] &quot;Raventós; Gonzalez; Mújica; Bonet&quot; ## [6] &quot;Shefferson; Kull; Tali; Kellett&quot; ## [7] &quot;Gregg; Kéry&quot; ## [8] &quot;Mondragón; Maldonado; Aguilar-Santelises&quot; ## [9] &quot;Raventós; García-González; Riverón-Giró; Damon&quot; ## [10] &quot;Crain; Tremblay; Ferguson&quot; ## [11] &quot;Tremblay&quot; ## [12] &quot;Tremblay; Raventós; Ackerman; &quot; ## [13] &quot;García-González; Damon; Raventós; Riverón-Giró; Mújica; Solís-Montero&quot; ## [14] &quot;Pellegrino; Bellusci&quot; ## [15] &quot;Zotz; Schmidt&quot; ## [16] &quot;Mondragón&quot; ## [17] &quot;Winkler; Hülber; Hietz&quot; ## [18] &quot;Tremblay; Ackerman&quot; ## [19] &quot;Calvo&quot; ## [20] &quot;Wells; Willems&quot; ## [21] &quot;Iriondo; Giménez-Benavides; Albert; Lozano; Escudero&quot; ## [22] &quot;Nicolè; Brzosko; Till-Bottraud&quot; ## [23] &quot;García; Goñi; Guzman&quot; ## [24] &quot;Thorpe; Stanley; Kayne; Latham&quot; ## [25] &quot;Zhongjian; Wenhui; Liqiang; Yuting&quot; ## [26] &quot;Shefferson; Warren II; Pulliam&quot; ## [27] &quot;Sletvold; Øien; Moen&quot; ## [28] &quot;Sletvold; Dahlgren; Øien; Moen; Ehrlén&quot; ## [29] &quot;Jäkäläniemi; Crone; Närhi; Tuomi&quot; ## [30] &quot;Wells; Rothery; Cox; Bamford&quot; ## [31] &quot;Pfeifer; Wiegand; Heinrich; Jetschke&quot; ## [32] &quot;Tremblay; McCarthy&quot; ## [33] &quot;Shefferson; Tali&quot; ## [34] &quot;Jacquemyns; Brys; Jongejans&quot; ## [35] &quot;Reddoch; Reddoch&quot; ## [36] &quot;Riverón-Giró; Raventós; Damon; García-González; Mújica&quot; ## [37] &quot;Ackerman; Tremblay; Pérez; Madden; Bechtold; Boeken&quot; 17.4 Cuantos estudios unicos? Para evaluar el largo de tiempo por estudio se necesita seleccionar una combinación de variables única NOTA: OrganismType es una variable que indica si la orquídea es un epifita o terrestre. Roberto MUCHOS estan erroneos. - Todos las Lepanthes son epifitas, pero hay unas que son terrestres en la base de datos. - Todas las Caladenia son terrestres, pero hay unas que son epifitas en la base de datos. #names(index_O) Los nombres de las variables SPECIES_O=index_O %&gt;% select(StudyStart, StudyEnd, SpeciesAccepted, YearPublication, Authors, DOI_ISBN, OrganismType, MatrixPopulation, mat) %&gt;% group_by(SpeciesAccepted, YearPublication, OrganismType, StudyStart, StudyEnd) %&gt;% summarize(n_populations = length(unique(MatrixPopulation))) %&gt;% arrange(desc(n_populations)) %&gt;% mutate(StudyStart=as.numeric(StudyStart)) %&gt;% mutate(StudyEnd=as.numeric(StudyEnd)) %&gt;% drop_na(StudyStart, StudyEnd) SPECIES_O %&gt;% head() ## # A tibble: 6 × 6 ## # Groups: SpeciesAccepted, YearPublication, OrganismType, StudyStart [6] ## SpeciesAccepted YearPublication OrganismType StudyStart StudyEnd n_populations ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; ## 1 Lepanthes cari… 2018 Epiphyte 2010 2012 18 ## 2 Epipactis atro… 2017 Herbaceous … 2000 2015 8 ## 3 Lepanthes rubr… 2010 Epiphyte 1994 2007 8 ## 4 Lepanthes rupe… 2001 Herbaceous … 1994 1996 7 ## 5 Lepanthes rupe… 2014 Herbaceous … 1993 1996 7 ## 6 Orchis purpurea 2010 Herbaceous … 2002 2008 7 #write_csv(SPECIES_O, &quot;Species_O.csv&quot;) 17.4.1 Determinar cuantas poblaciones se uso para la investigaciones La cantidad de poblaciones por especies en la base de datos de COMPADRE. La mayoria de los estudios usaron una sola población, pero hay estudios que usaron hasta 18 poblaciones distintas. Estas poblaciones pudiese ser de diferentes publicaciones. as.data.frame(table(SPECIES_O$n_populations)) ## Var1 Freq ## 1 1 27 ## 2 2 7 ## 3 3 4 ## 4 4 6 ## 5 6 4 ## 6 7 3 ## 7 8 2 ## 8 18 1 17.4.2 Evaluación de cuando comenzaron y terminaron La duración de los estudios en la base de datos de COMPADRE. La mayoría de los estudios duraron pocos años. Aquí vemos cuando comenzaron los estudios comenzaron y terminaron basado si las plantas son epifitas o no. SPECIES_O$SpeciesAccepted &lt;- fct_reorder(SPECIES_O$SpeciesAccepted, SPECIES_O$StudyStart, .desc = FALSE) ggplot(SPECIES_O, aes(SpeciesAccepted, color=OrganismType))+ geom_linerange(aes(x= SpeciesAccepted , ymin=StudyStart, ymax=StudyEnd))+ coord_flip()+ theme(legend.position = c(0.2, 0.8))+ ylab(&quot;&quot;)+ xlab(&quot;&quot;)+ rlt_theme+ theme(axis.text.x = element_text(color = &quot;grey20&quot;, size = 9, angle = 90, hjust = .5, vjust = .5, face = &quot;plain&quot;), axis.text.y = element_text(color = &quot;grey20&quot;, size = 7, angle = 0, hjust = 1, vjust = 0, face = &quot;plain&quot;), axis.title.x = element_text(color = &quot;grey20&quot;, size = 12, angle = 0, hjust = .5, vjust = 0, face = &quot;plain&quot;), axis.title.y = element_text(color = &quot;grey20&quot;, size = 12, angle = 90, hjust = .5, vjust = .5, face = &quot;plain&quot;)) ## Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2 ## 3.5.0. ## ℹ Please use the `legend.position.inside` argument of `theme()` instead. ## This warning is displayed once every 8 hours. ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was ## generated. ggsave(&quot;Lenght_survey.png&quot;) ## Saving 7 x 5 in image 17.4.3 El tiempo de duración de las investigaciones en la base de datos de COMPADRE. Figura de las duración de las investigaciones en la base de datos de COMPADRE. La mayoría de los estudios de orquideas epifitas duraron pocos años al comparar con especies rterrestres. index_O=index_O %&gt;% mutate(StudyDuration=as.numeric(StudyDuration)) table(index_O$StudyDuration) ## ## 2 3 4 5 6 7 8 9 10 11 12 13 14 16 17 19 26 30 ## 2 211 37 2 82 43 26 47 28 2 9 6 86 53 7 1 1 3 table(index_O$OrganismType) ## ## Epiphyte Herbaceous perennial ## 248 399 ggplot(index_O, aes(StudyDuration, fill=OrganismType))+ geom_histogram(colour=&quot;white&quot;)+ facet_wrap(~OrganismType)+ theme(legend.position = &quot;none&quot;)+ xlab(&quot;Study duration&quot;)+ ylab(&quot;Frequency&quot;)+ rlt_theme ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## Warning: Removed 1 row containing non-finite outside the scale range ## (`stat_bin()`). #ggsave(&quot;Duración_Epi_Ter.pdf&quot;) ggsave(&quot;Duración_Epi_Ter.png&quot;) ## Saving 7 x 5 in image ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## Warning: Removed 1 row containing non-finite outside the scale range ## (`stat_bin()`). 17.4.4 Amalgamando todas las matrices y su información index &lt;- which(compadre$metadata$Family==&quot;Orchidaceae&quot;) names(Compadre) ## [1] &quot;mat&quot; &quot;SpeciesAuthor&quot; &quot;SpeciesAccepted&quot; ## [4] &quot;CommonName&quot; &quot;Genus&quot; &quot;Family&quot; ## [7] &quot;Order&quot; &quot;Class&quot; &quot;Phylum&quot; ## [10] &quot;Kingdom&quot; &quot;OrganismType&quot; &quot;DicotMonoc&quot; ## [13] &quot;AngioGymno&quot; &quot;Authors&quot; &quot;Journal&quot; ## [16] &quot;YearPublication&quot; &quot;DOI_ISBN&quot; &quot;AdditionalSource&quot; ## [19] &quot;StudyDuration&quot; &quot;StudyStart&quot; &quot;StudyEnd&quot; ## [22] &quot;ProjectionInterval&quot; &quot;NumberPopulations&quot; &quot;MatrixCriteriaSize&quot; ## [25] &quot;MatrixCriteriaOntogeny&quot; &quot;MatrixCriteriaAge&quot; &quot;MatrixPopulation&quot; ## [28] &quot;Lat&quot; &quot;Lon&quot; &quot;Altitude&quot; ## [31] &quot;Country&quot; &quot;Continent&quot; &quot;Ecoregion&quot; ## [34] &quot;StudiedSex&quot; &quot;MatrixComposite&quot; &quot;MatrixTreatment&quot; ## [37] &quot;MatrixCaptivity&quot; &quot;MatrixStartYear&quot; &quot;MatrixStartSeason&quot; ## [40] &quot;MatrixStartMonth&quot; &quot;MatrixEndYear&quot; &quot;MatrixEndSeason&quot; ## [43] &quot;MatrixEndMonth&quot; &quot;MatrixSplit&quot; &quot;MatrixFec&quot; ## [46] &quot;Observation&quot; &quot;MatrixDimension&quot; &quot;SurvivalIssue&quot; ## [49] &quot;AnnualPeriodicity&quot; subset(index_O, Family ==&quot;Orchidaceae&quot; &amp; MatrixDimension &gt;2) ## A COM(P)ADRE database (&#39;CompadreDB&#39;) object with 46 SPECIES and 647 MATRICES. ## ## # A tibble: 647 × 59 ## mat MatrixID SpeciesAuthor SpeciesAccepted CommonName Kingdom Phylum ## &lt;list&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; ## 1 &lt;CompdrMt&gt; 238285 Caladenia_amon… Caladenia amon… &lt;NA&gt; Plantae Trach… ## 2 &lt;CompdrMt&gt; 238286 Caladenia_argo… Caladenia argo… &lt;NA&gt; Plantae Trach… ## 3 &lt;CompdrMt&gt; 238287 Caladenia_clav… Caladenia clav… &lt;NA&gt; Plantae Trach… ## 4 &lt;CompdrMt&gt; 238288 Caladenia_eleg… Caladenia eleg… &lt;NA&gt; Plantae Trach… ## 5 &lt;CompdrMt&gt; 238289 Caladenia_gran… Caladenia gran… &lt;NA&gt; Plantae Trach… ## 6 &lt;CompdrMt&gt; 238290 Caladenia_macr… Caladenia macr… &lt;NA&gt; Plantae Trach… ## 7 &lt;CompdrMt&gt; 238291 Caladenia_oeno… Caladenia oeno… &lt;NA&gt; Plantae Trach… ## 8 &lt;CompdrMt&gt; 238292 Caladenia_rose… Caladenia rose… &lt;NA&gt; Plantae Trach… ## 9 &lt;CompdrMt&gt; 238293 Caladenia_vali… Caladenia vali… &lt;NA&gt; Plantae Trach… ## 10 &lt;CompdrMt&gt; 238565 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach… ## # ℹ 637 more rows ## # ℹ 52 more variables: Class &lt;chr&gt;, Order &lt;chr&gt;, Family &lt;chr&gt;, Genus &lt;chr&gt;, ## # Species &lt;chr&gt;, Infraspecies &lt;chr&gt;, InfraspeciesType &lt;chr&gt;, ## # OrganismType &lt;chr&gt;, DicotMonoc &lt;chr&gt;, AngioGymno &lt;chr&gt;, Authors &lt;chr&gt;, ## # Journal &lt;chr&gt;, SourceType &lt;chr&gt;, OtherType &lt;chr&gt;, YearPublication &lt;chr&gt;, ## # DOI_ISBN &lt;chr&gt;, AdditionalSource &lt;chr&gt;, StudyDuration &lt;dbl&gt;, ## # StudyStart &lt;chr&gt;, StudyEnd &lt;chr&gt;, ProjectionInterval &lt;chr&gt;, … subset(index_O,DicotMonoc == &quot;Eudicot&quot; &amp; Country %in% c(&quot;USA&quot;, &quot;CAN&quot;) &amp; MatrixDimension &gt; 2) ## A COM(P)ADRE database (&#39;CompadreDB&#39;) object with 0 SPECIES and 0 MATRICES. ## ## # A tibble: 0 × 59 ## # ℹ 59 variables: mat &lt;list&gt;, MatrixID &lt;int&gt;, SpeciesAuthor &lt;chr&gt;, ## # SpeciesAccepted &lt;chr&gt;, CommonName &lt;chr&gt;, Kingdom &lt;chr&gt;, Phylum &lt;chr&gt;, ## # Class &lt;chr&gt;, Order &lt;chr&gt;, Family &lt;chr&gt;, Genus &lt;chr&gt;, Species &lt;chr&gt;, ## # Infraspecies &lt;chr&gt;, InfraspeciesType &lt;chr&gt;, OrganismType &lt;chr&gt;, ## # DicotMonoc &lt;chr&gt;, AngioGymno &lt;chr&gt;, Authors &lt;chr&gt;, Journal &lt;chr&gt;, ## # SourceType &lt;chr&gt;, OtherType &lt;chr&gt;, YearPublication &lt;chr&gt;, DOI_ISBN &lt;chr&gt;, ## # AdditionalSource &lt;chr&gt;, StudyDuration &lt;dbl&gt;, StudyStart &lt;chr&gt;, … #cdb_compare(index_O,x) x &lt;- subset(index_O,Family == &quot;Orchidaceae&quot;) x_OT=x %&gt;% group_by(OrganismType) #Orchids_New=as_cdb(index) #compadre$mat[index] Compadre_flagged &lt;- cdb_flag(index_O) x &lt;- subset(Compadre_flagged, check_NA_A == FALSE &amp; check_ergodic == TRUE) x ## A COM(P)ADRE database (&#39;CompadreDB&#39;) object with 45 SPECIES and 484 MATRICES. ## ## # A tibble: 484 × 73 ## mat MatrixID SpeciesAuthor SpeciesAccepted CommonName Kingdom Phylum ## &lt;list&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; ## 1 &lt;CompdrMt&gt; 238285 Caladenia_amon… Caladenia amon… &lt;NA&gt; Plantae Trach… ## 2 &lt;CompdrMt&gt; 238286 Caladenia_argo… Caladenia argo… &lt;NA&gt; Plantae Trach… ## 3 &lt;CompdrMt&gt; 238287 Caladenia_clav… Caladenia clav… &lt;NA&gt; Plantae Trach… ## 4 &lt;CompdrMt&gt; 238288 Caladenia_eleg… Caladenia eleg… &lt;NA&gt; Plantae Trach… ## 5 &lt;CompdrMt&gt; 238289 Caladenia_gran… Caladenia gran… &lt;NA&gt; Plantae Trach… ## 6 &lt;CompdrMt&gt; 238290 Caladenia_macr… Caladenia macr… &lt;NA&gt; Plantae Trach… ## 7 &lt;CompdrMt&gt; 238291 Caladenia_oeno… Caladenia oeno… &lt;NA&gt; Plantae Trach… ## 8 &lt;CompdrMt&gt; 238292 Caladenia_rose… Caladenia rose… &lt;NA&gt; Plantae Trach… ## 9 &lt;CompdrMt&gt; 238293 Caladenia_vali… Caladenia vali… &lt;NA&gt; Plantae Trach… ## 10 &lt;CompdrMt&gt; 238565 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach… ## # ℹ 474 more rows ## # ℹ 66 more variables: Class &lt;chr&gt;, Order &lt;chr&gt;, Family &lt;chr&gt;, Genus &lt;chr&gt;, ## # Species &lt;chr&gt;, Infraspecies &lt;chr&gt;, InfraspeciesType &lt;chr&gt;, ## # OrganismType &lt;chr&gt;, DicotMonoc &lt;chr&gt;, AngioGymno &lt;chr&gt;, Authors &lt;chr&gt;, ## # Journal &lt;chr&gt;, SourceType &lt;chr&gt;, OtherType &lt;chr&gt;, YearPublication &lt;chr&gt;, ## # DOI_ISBN &lt;chr&gt;, AdditionalSource &lt;chr&gt;, StudyDuration &lt;dbl&gt;, ## # StudyStart &lt;chr&gt;, StudyEnd &lt;chr&gt;, ProjectionInterval &lt;chr&gt;, … y &lt;- subset(Compadre_flagged, check_NA_A == FALSE &amp; check_irreducible == TRUE) y ## A COM(P)ADRE database (&#39;CompadreDB&#39;) object with 43 SPECIES and 360 MATRICES. ## ## # A tibble: 360 × 73 ## mat MatrixID SpeciesAuthor SpeciesAccepted CommonName Kingdom Phylum ## &lt;list&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; ## 1 &lt;CompdrMt&gt; 238285 Caladenia_amon… Caladenia amon… &lt;NA&gt; Plantae Trach… ## 2 &lt;CompdrMt&gt; 238286 Caladenia_argo… Caladenia argo… &lt;NA&gt; Plantae Trach… ## 3 &lt;CompdrMt&gt; 238287 Caladenia_clav… Caladenia clav… &lt;NA&gt; Plantae Trach… ## 4 &lt;CompdrMt&gt; 238288 Caladenia_eleg… Caladenia eleg… &lt;NA&gt; Plantae Trach… ## 5 &lt;CompdrMt&gt; 238289 Caladenia_gran… Caladenia gran… &lt;NA&gt; Plantae Trach… ## 6 &lt;CompdrMt&gt; 238290 Caladenia_macr… Caladenia macr… &lt;NA&gt; Plantae Trach… ## 7 &lt;CompdrMt&gt; 238291 Caladenia_oeno… Caladenia oeno… &lt;NA&gt; Plantae Trach… ## 8 &lt;CompdrMt&gt; 238292 Caladenia_rose… Caladenia rose… &lt;NA&gt; Plantae Trach… ## 9 &lt;CompdrMt&gt; 238293 Caladenia_vali… Caladenia vali… &lt;NA&gt; Plantae Trach… ## 10 &lt;CompdrMt&gt; 238565 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach… ## # ℹ 350 more rows ## # ℹ 66 more variables: Class &lt;chr&gt;, Order &lt;chr&gt;, Family &lt;chr&gt;, Genus &lt;chr&gt;, ## # Species &lt;chr&gt;, Infraspecies &lt;chr&gt;, InfraspeciesType &lt;chr&gt;, ## # OrganismType &lt;chr&gt;, DicotMonoc &lt;chr&gt;, AngioGymno &lt;chr&gt;, Authors &lt;chr&gt;, ## # Journal &lt;chr&gt;, SourceType &lt;chr&gt;, OtherType &lt;chr&gt;, YearPublication &lt;chr&gt;, ## # DOI_ISBN &lt;chr&gt;, AdditionalSource &lt;chr&gt;, StudyDuration &lt;dbl&gt;, ## # StudyStart &lt;chr&gt;, StudyEnd &lt;chr&gt;, ProjectionInterval &lt;chr&gt;, … xy &lt;- subset(Compadre_flagged, check_NA_A == FALSE &amp; check_irreducible == TRUE &amp; check_ergodic == TRUE) xy ## A COM(P)ADRE database (&#39;CompadreDB&#39;) object with 43 SPECIES and 360 MATRICES. ## ## # A tibble: 360 × 73 ## mat MatrixID SpeciesAuthor SpeciesAccepted CommonName Kingdom Phylum ## &lt;list&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; ## 1 &lt;CompdrMt&gt; 238285 Caladenia_amon… Caladenia amon… &lt;NA&gt; Plantae Trach… ## 2 &lt;CompdrMt&gt; 238286 Caladenia_argo… Caladenia argo… &lt;NA&gt; Plantae Trach… ## 3 &lt;CompdrMt&gt; 238287 Caladenia_clav… Caladenia clav… &lt;NA&gt; Plantae Trach… ## 4 &lt;CompdrMt&gt; 238288 Caladenia_eleg… Caladenia eleg… &lt;NA&gt; Plantae Trach… ## 5 &lt;CompdrMt&gt; 238289 Caladenia_gran… Caladenia gran… &lt;NA&gt; Plantae Trach… ## 6 &lt;CompdrMt&gt; 238290 Caladenia_macr… Caladenia macr… &lt;NA&gt; Plantae Trach… ## 7 &lt;CompdrMt&gt; 238291 Caladenia_oeno… Caladenia oeno… &lt;NA&gt; Plantae Trach… ## 8 &lt;CompdrMt&gt; 238292 Caladenia_rose… Caladenia rose… &lt;NA&gt; Plantae Trach… ## 9 &lt;CompdrMt&gt; 238293 Caladenia_vali… Caladenia vali… &lt;NA&gt; Plantae Trach… ## 10 &lt;CompdrMt&gt; 238565 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach… ## # ℹ 350 more rows ## # ℹ 66 more variables: Class &lt;chr&gt;, Order &lt;chr&gt;, Family &lt;chr&gt;, Genus &lt;chr&gt;, ## # Species &lt;chr&gt;, Infraspecies &lt;chr&gt;, InfraspeciesType &lt;chr&gt;, ## # OrganismType &lt;chr&gt;, DicotMonoc &lt;chr&gt;, AngioGymno &lt;chr&gt;, Authors &lt;chr&gt;, ## # Journal &lt;chr&gt;, SourceType &lt;chr&gt;, OtherType &lt;chr&gt;, YearPublication &lt;chr&gt;, ## # DOI_ISBN &lt;chr&gt;, AdditionalSource &lt;chr&gt;, StudyDuration &lt;dbl&gt;, ## # StudyStart &lt;chr&gt;, StudyEnd &lt;chr&gt;, ProjectionInterval &lt;chr&gt;, … lambdaVals &lt;- sapply(matA(xy), popdemo::eigs, what=&quot;lambda&quot;) summary(lambdaVals) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0.3888 0.9407 0.9993 0.9891 1.0313 1.7760 hist(lambdaVals, main = &quot;Lambda values&quot;) library(purrr) lambdaVals1 &lt;- map_dbl(matA(xy), ~popdemo::eigs(.x, what=&quot;lambda&quot;)) #Or with popbio, which avoids some warning messages… lambdaVals2 &lt;- map_dbl(matA(xy), ~popbio::lambda(.x)) x2=xy %&gt;% mutate(OrganismType = case_when( Genus == &quot;Caladenia&quot; &amp; OrganismType == &quot;Epiphyte&quot; ~ &quot;Herbaceous perennial&quot;, TRUE ~ OrganismType )) epi=x2 %&gt;% filter(OrganismType==&quot;Epiphyte&quot;) terr=x2 %&gt;% filter(OrganismType==&quot;Herbaceous perennial&quot;) Compadre_flagged &lt;- cdb_flag(index_O) x &lt;- subset(Compadre_flagged, check_NA_A == FALSE &amp; check_ergodic == TRUE) lambdaVals &lt;- sapply(matA(x), popdemo::eigs, what=“lambda”) summary(lambdaVals) hist(lambdaVals, main = “Lambda values”) Compadre_flagged_epi &lt;- cdb_flag(epi) x_epi &lt;- subset(Compadre_flagged_epi, check_NA_A == FALSE &amp; check_ergodic == TRUE) #sapply(matA(x_epi), popdemo::eigs, what=&quot;lambda&quot;) library(purrr) lambda_epi &lt;- map_dbl(matA(x_epi), ~popdemo::eigs(.x, what=&quot;lambda&quot;)) #Or with popbio, which avoids some warning messages… lambda_terr &lt;- map_dbl(matA(terr), ~popbio::lambda(.x)) summary(lambda_epi) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0.3888 0.9715 1.0003 0.9716 1.0124 1.3592 hist(lambda_epi, main = &quot;Lambda values&quot;) summary(lambda_terr) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0.4089 0.9329 0.9988 0.9973 1.0516 1.7760 hist(lambda_terr, main = &quot;Lambda values&quot;) df_Lamb_epi=as.data.frame(lambda_epi) df_Lamb_epi=df_Lamb_epi %&gt;% add_column(Habit_Type = &quot;Epiphyte&quot;) %&gt;% rename(lambda=lambda_epi) df_Lamb_terr=as.data.frame(lambda_terr) df_Lamb_terr=df_Lamb_terr %&gt;% add_column(Habit_Type = &quot;Terrestrial&quot;)%&gt;% rename(lambda=lambda_terr) ALL_Lambdas=rbind(df_Lamb_epi, df_Lamb_terr) ggplot(ALL_Lambdas, aes(lambda, fill=Habit_Type ))+ geom_histogram(colour=&quot;white&quot;) + facet_wrap( ~Habit_Type)+ rlt_theme ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ggsave(&quot;Terr_Epi_lambda.png&quot;) ## Saving 7 x 5 in image ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. model_lambda=lm(lambda ~ Habit_Type-1, data=ALL_Lambdas) summary(model_lambda) ## ## Call: ## lm(formula = lambda ~ Habit_Type - 1, data = ALL_Lambdas) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.58838 -0.04452 0.01335 0.04734 0.77877 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## Habit_TypeEpiphyte 0.971600 0.013069 74.34 &lt;2e-16 *** ## Habit_TypeTerrestrial 0.997261 0.008897 112.10 &lt;2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.1395 on 358 degrees of freedom ## Multiple R-squared: 0.9806, Adjusted R-squared: 0.9805 ## F-statistic: 9046 on 2 and 358 DF, p-value: &lt; 2.2e-16 library(broom) tidy(model_lambda) ## # A tibble: 2 × 5 ## term estimate std.error statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 Habit_TypeEpiphyte 0.972 0.0131 74.3 9.92e-220 ## 2 Habit_TypeTerrestrial 0.997 0.00890 112. 6.91e-281 library(ggdist) library(distributional) model_lambda %&gt;% tidy() %&gt;% ggplot(aes(y = term)) + stat_halfeye( aes(xdist = dist_student_t(df = df.residual(model_lambda), mu = estimate, sigma = std.error)) ) ALL_Lambdas %&gt;% expand(Habit_Type) %&gt;% augment(model_lambda, newdata = ., se_fit = TRUE) %&gt;% ggplot(aes(y = Habit_Type, colour=Habit_Type)) + stat_halfeye( aes(xdist = dist_student_t(df = df.residual(model_lambda), mu = .fitted, sigma = .se.fit)), scale = .5 ) + # we&#39;ll add the data back in too (scale = .5 above adjusts the halfeye height so # that the data fit in as well) geom_point(aes(x = lambda), data = ALL_Lambdas, pch = &quot;|&quot;, size = 2, position = position_nudge(y = -.15)) 17.4.5 The number of populations x2 %&gt;% group_by(SpeciesAccepted) %&gt;% summarize(n_populations = length(unique(MatrixPopulation))) %&gt;% arrange(desc(n_populations)) ## # A tibble: 43 × 2 ## SpeciesAccepted n_populations ## &lt;chr&gt; &lt;int&gt; ## 1 Lepanthes rubripetala 20 ## 2 Lepanthes rupestris 14 ## 3 Lepanthes caritensis 13 ## 4 Cypripedium calceolus 8 ## 5 Orchis purpurea 7 ## 6 Neotinea ustulata 6 ## 7 Serapias cordigera 6 ## 8 Cypripedium fasciculatum 4 ## 9 Epipactis atrorubens 4 ## 10 Oeceoclades maculata 4 ## # ℹ 33 more rows compadre_replicated_pops &lt;- x2 %&gt;% group_by(SpeciesAccepted) %&gt;% mutate(n_pops = length(unique(MatrixPopulation))) %&gt;% ungroup() %&gt;% subset(n_pops &gt;= 10) compadre_replicated_pops ## A COM(P)ADRE database (&#39;CompadreDB&#39;) object with 3 SPECIES and 88 MATRICES. ## ## # A tibble: 88 × 74 ## mat MatrixID SpeciesAuthor SpeciesAccepted CommonName Kingdom Phylum ## &lt;list&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; ## 1 &lt;CompdrMt&gt; 238838 Lepanthes_rubr… Lepanthes rubr… &lt;NA&gt; Plantae Magno… ## 2 &lt;CompdrMt&gt; 239751 Lepanthes_cari… Lepanthes cari… &lt;NA&gt; Plantae Magno… ## 3 &lt;CompdrMt&gt; 239752 Lepanthes_cari… Lepanthes cari… &lt;NA&gt; Plantae Magno… ## 4 &lt;CompdrMt&gt; 239756 Lepanthes_cari… Lepanthes cari… &lt;NA&gt; Plantae Magno… ## 5 &lt;CompdrMt&gt; 239764 Lepanthes_cari… Lepanthes cari… &lt;NA&gt; Plantae Magno… ## 6 &lt;CompdrMt&gt; 239769 Lepanthes_cari… Lepanthes cari… &lt;NA&gt; Plantae Magno… ## 7 &lt;CompdrMt&gt; 239771 Lepanthes_cari… Lepanthes cari… &lt;NA&gt; Plantae Magno… ## 8 &lt;CompdrMt&gt; 239772 Lepanthes_cari… Lepanthes cari… &lt;NA&gt; Plantae Magno… ## 9 &lt;CompdrMt&gt; 239775 Lepanthes_cari… Lepanthes cari… &lt;NA&gt; Plantae Magno… ## 10 &lt;CompdrMt&gt; 239776 Lepanthes_cari… Lepanthes cari… &lt;NA&gt; Plantae Magno… ## # ℹ 78 more rows ## # ℹ 67 more variables: Class &lt;chr&gt;, Order &lt;chr&gt;, Family &lt;chr&gt;, Genus &lt;chr&gt;, ## # Species &lt;chr&gt;, Infraspecies &lt;chr&gt;, InfraspeciesType &lt;chr&gt;, ## # OrganismType &lt;chr&gt;, DicotMonoc &lt;chr&gt;, AngioGymno &lt;chr&gt;, Authors &lt;chr&gt;, ## # Journal &lt;chr&gt;, SourceType &lt;chr&gt;, OtherType &lt;chr&gt;, YearPublication &lt;chr&gt;, ## # DOI_ISBN &lt;chr&gt;, AdditionalSource &lt;chr&gt;, StudyDuration &lt;dbl&gt;, ## # StudyStart &lt;chr&gt;, StudyEnd &lt;chr&gt;, ProjectionInterval &lt;chr&gt;, … 17.4.6 Crear un mapa de las distribuciones de las orquídeas en la base de datos de COMPADRE. plot(index_O$Lon,index_O$Lat,main = &quot;Location&quot;) ggplot2::ggplot(x2, aes(Lon, Lat)) + borders(database = &quot;world&quot;, fill = &quot;grey80&quot;, col = NA) + geom_point(col = &quot;steelblue&quot;, size = 1.8, alpha = 0.8) ## Warning: Removed 27 rows containing missing values or values outside the scale range ## (`geom_point()`). ggsave(&quot;orchid_map.jpg&quot;) ## Saving 7 x 5 in image ## Warning: Removed 27 rows containing missing values or values outside the scale range ## (`geom_point()`). 17.5 Important to include only matrices that are annual. Unless we data wrangle the life span so it represent a year worth instead of life span. # function to calculate life expectancy lifeExpectancy &lt;- function(matU, startLife) { N &lt;- solve(diag(nrow(matU)) - matU) return(colSums(N)[startLife]) } compadre_life_expect &lt;- x2 %&gt;% filter(ProjectionInterval &gt;0.7) |&gt; filter(MatrixComposite == &quot;Mean&quot;, # filter is the dplyr version of subset MatrixTreatment == &quot;Unmanipulated&quot;, MatrixCaptivity == &quot;W&quot;, #ProjectionInterval == &quot;1&quot; ) %&gt;% mutate(StageID = cdb_id_stages(.)) %&gt;% cdb_collapse(columns = &quot;StageID&quot;) %&gt;% cdb_flag() %&gt;% filter(check_NA_U == FALSE, check_zero_U == FALSE, check_singular_U == FALSE) %&gt;% mutate(matU = matU(.), start_life = mpm_first_active(.)) %&gt;% mutate(life_expectancy = mapply(lifeExpectancy, matU, start_life)) %&gt;% # filter(life_expectancy &gt;= 1) %&gt;% mutate(OrganismType = reorder(OrganismType, life_expectancy, median)) compadre_life_expect |&gt; group_by(OrganismType) |&gt; summarize(mean_LS= mean(life_expectancy, na.rm=TRUE), sd_LS = sd(life_expectancy, na.rm=TRUE)) ## # A tibble: 2 × 3 ## OrganismType mean_LS sd_LS ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 Epiphyte 11.6 14.9 ## 2 Herbaceous perennial 8.26 9.27 ggplot2::ggplot(compadre_life_expect, aes(OrganismType, life_expectancy, colour=OrganismType)) + geom_boxplot() +geom_point()+ scale_y_log10() + coord_flip() + labs(x = NULL, y = &quot;Life expectancy (log(years))&quot;)+ rlt_theme+ theme(legend.position = &quot;none&quot;) ## Warning: Removed 1 row containing non-finite outside the scale range ## (`stat_boxplot()`). ## Warning: Removed 1 row containing missing values or values outside the scale range ## (`geom_point()`). ggsave(&quot;Life_Span.png&quot;) ## Saving 7 x 5 in image ## Warning: Removed 1 row containing non-finite outside the scale range (`stat_boxplot()`). ## Removed 1 row containing missing values or values outside the scale range ## (`geom_point()`). https://jonesor.github.io/Rage/reference/life_expect.html How to calculate CI of life span #SPECIES_O$SpeciesAccepted &lt;- fct_reorder(SPECIES_O$SpeciesAccepted, SPECIES_O$StudyStart, .desc = FALSE) compadre_life_expect |&gt; select(mat, Genus, SpeciesAccepted, life_expectancy) |&gt; group_by(SpeciesAccepted) |&gt; summarize(mean_LS= mean(life_expectancy, na.rm=TRUE), sd_LS = sd(life_expectancy, na.rm=TRUE)) ## # A tibble: 29 × 3 ## SpeciesAccepted mean_LS sd_LS ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 Aspasia principissa 5.43 NA ## 2 Broughtonia cubensis 15.0 NA ## 3 Caladenia amonea 6.96 NA ## 4 Caladenia argocalla 2.27 NA ## 5 Caladenia clavigera 5.89 NA ## 6 Caladenia elegans 3.01 NA ## 7 Caladenia graniticola 3.65 NA ## 8 Caladenia macroclavia 2.31 NA ## 9 Caladenia oenochila 3.94 NA ## 10 Caladenia rosella 4.48 NA ## # ℹ 19 more rows ggplot(compadre_life_expect, aes(x=reorder(SpeciesAccepted, life_expectancy), life_expectancy, colour=OrganismType)) + # geom_boxplot() + geom_point()+ scale_y_log10() + coord_flip() + labs(x = NULL, y = &quot;Life expectancy (log(years))&quot;) ## Warning: Removed 1 row containing missing values or values outside the scale range ## (`geom_point()`). # rlt_theme+ #theme(legend.position = &quot;none&quot;) ggsave(&quot;Genus_Life_Span.png&quot;) ## Saving 7 x 5 in image ## Warning: Removed 1 row containing missing values or values outside the scale range ## (`geom_point()`). #SPECIES_O$SpeciesAccepted &lt;- fct_reorder(SPECIES_O$SpeciesAccepted, SPECIES_O$StudyStart, .desc = FALSE) compadre_life_expect |&gt; group_by(Genus) |&gt; summarize(mean_LS= mean(life_expectancy, na.rm=TRUE), sd_LS = sd(life_expectancy, na.rm=TRUE)) |&gt; filter(Genus %in% c(&quot;Caladenia&quot;)) ## # A tibble: 1 × 3 ## Genus mean_LS sd_LS ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 Caladenia 3.90 1.64 compadre_life_expect |&gt; filter(Genus %in% c(&quot;Caladenia&quot;)) |&gt; ggplot( aes(x=reorder(SpeciesAccepted, life_expectancy), life_expectancy, colour=OrganismType)) + geom_point()+ scale_y_log10() + coord_flip() + labs(x = NULL, y = &quot;Life expectancy (years)&quot;)+ rlt_theme+ theme(legend.position = &quot;none&quot;) ggsave(&quot;Caladenia_Life_Span.png&quot;) ## Saving 7 x 5 in image Test difference in life span. unique(compadre_life_expect$OrganismType) ## [1] Herbaceous perennial Epiphyte ## Levels: Epiphyte Herbaceous perennial t.test(life_expectancy~OrganismType, data=compadre_life_expect) ## ## Welch Two Sample t-test ## ## data: life_expectancy by OrganismType ## t = 0.69168, df = 16.201, p-value = 0.4989 ## alternative hypothesis: true difference in means between group Epiphyte and group Herbaceous perennial is not equal to 0 ## 95 percent confidence interval: ## -6.806699 13.409443 ## sample estimates: ## mean in group Epiphyte mean in group Herbaceous perennial ## 11.556907 8.255534 shapiro.test(compadre_life_expect$life_expectancy) # Not normaly distributed ## ## Shapiro-Wilk normality test ## ## data: compadre_life_expect$life_expectancy ## W = 0.63295, p-value = 9.944e-08 library(car) ## Loading required package: carData ## ## Attaching package: &#39;car&#39; ## The following object is masked from &#39;package:dplyr&#39;: ## ## recode ## The following object is masked from &#39;package:purrr&#39;: ## ## some leveneTest(life_expectancy~OrganismType, data=compadre_life_expect) # equal variance but not notmaly distributed ## Levene&#39;s Test for Homogeneity of Variance (center = median) ## Df F value Pr(&gt;F) ## group 1 0.1166 0.7352 ## 30 Use robust Approach Para el siguiente análisis se necesita instalar el paquete WRS2. Y se necesita cargar el archivo de funciones de Rallfun-v38.txt que se encuentra en el siguiente enlace &lt;https://github.com/rrwilcox/Rallfun&gt; y guardarlo en su directorio de trabajo. Pudiese ser que haya versiones más recientes de este archivo. Nota que el codigo abajo funciona para mi computadora, uds tienen que ajustar la dirección del archivo a su directorio de trabajo. library(WRS2) source(&quot;/Users/rlt/Library/CloudStorage/Dropbox/GitHub_Dropbox_Drive/GitHub/Diagnostico_Poblacional/Diagnostico_Poblacional/Rallfun-v38.txt&quot;, chdir = T) # Home computer #source(&quot;/Users/rlt/Dropbox/METAS+COHORT_D/Rallfun-v38.txt&quot;, chdir = T) #source(&quot;/Users/rlt/Dropbox/Ackermanstuff/Pollinator_Interaction/Specificity_Index_pollinators/Rallfun-v38.txt&quot;, chdir = T) ## Work laptop Computer #source(&quot;/Users/raymondtremblay/Dropbox/METAS+COHORT_D/Rallfun-v38.txt&quot;, chdir = T) #When used on Monique unique(compadre_life_expect$OrganismType) ## [1] Herbaceous perennial Epiphyte ## Levels: Epiphyte Herbaceous perennial Cf=cdb_flatten(compadre_life_expect) YSEC_T=Cf %&gt;% dplyr::select(&quot;life_expectancy&quot;, &quot;OrganismType&quot;) %&gt;% filter(OrganismType== &quot;Herbaceous perennial&quot;) YSEC_T ## # A tibble: 21 × 2 ## life_expectancy OrganismType ## &lt;dbl&gt; &lt;fct&gt; ## 1 6.96 Herbaceous perennial ## 2 2.27 Herbaceous perennial ## 3 5.89 Herbaceous perennial ## 4 3.01 Herbaceous perennial ## 5 3.65 Herbaceous perennial ## 6 2.31 Herbaceous perennial ## 7 3.94 Herbaceous perennial ## 8 4.48 Herbaceous perennial ## 9 2.55 Herbaceous perennial ## 10 21.2 Herbaceous perennial ## # ℹ 11 more rows YSEC_E=Cf %&gt;% dplyr::select(&quot;life_expectancy&quot;, &quot;OrganismType&quot;) %&gt;% filter(OrganismType== &quot;Epiphyte&quot;) yuenbt(YSEC_T$life_expectancy, YSEC_E$life_expectancy, alpha=.05, nboot=10000, side=T) ## $ci ## [1] -6.792134 3.155724 ## ## $test.stat ## [1] -0.7572641 ## ## $p.value ## [1] 0.4438 ## ## $est.1 ## [1] 5.454196 ## ## $est.2 ## [1] 7.272401 ## ## $est.dif ## [1] -1.818205 ## ## $n1 ## [1] 20 ## ## $n2 ## [1] 12 library(Rcompadre) library(popdemo) ## Welcome to popdemo! This is version 1.3-0 ## Use ?popdemo for an intro, or browseVignettes(&#39;popdemo&#39;) for vignettes ## Citation for popdemo is here: doi.org/10.1111/j.2041-210X.2012.00222.x ## Development and legacy versions are here: github.com/iainmstott/popdemo data(Compadre) Compadre$matA &lt;- matA(Compadre) # create empty vector to store output Compadre$dim &lt;- numeric(nrow(Compadre)) index$dim &lt;- numeric(nrow(index_O)) ## Warning in index$dim &lt;- numeric(nrow(index_O)): Coercing LHS to a list # loop through all rows of Compadre for (i in seq_len(nrow(Compadre))) { Compadre$dim[i] &lt;- nrow(Compadre$matA[[i]]) } # function to determine whether matrix &#39;mat&#39; has any stages with no transitions NullStages &lt;- function(mat) any(colSums(mat) == 0) # apply function to every element of A Compadre$null_stages &lt;- sapply(Compadre$matA, NullStages) NullStages(Compadre$matA[[1]]) # apply function to single element ## [1] FALSE Compadre$null_stages &lt;- sapply(matA(Compadre), NullStages) "]]
